{"name":"algorithm-crodic","path":"/post/algorithm-crodic","title":"CRODIC算法简析","category":"软件设计","date":["2014","09","25"],"tag":["C","数值求解","算法"],"layout":"post","toc":[{"tocTitle":"算法原理","bolt":"BE7AE97E6B395E58E9FE79086","child":[{"tocTitle":"坐标旋转","bolt":"BE59D90E6A087E6978BE8BDAC","parent":"BE7AE97E6B395E58E9FE79086"},{"tocTitle":"二分查找","bolt":"BE4BA8CE58886E69FA5E689BE","parent":"BE7AE97E6B395E58E9FE79086"},{"tocTitle":"去除公因子","bolt":"BE58EBBE999A4E585ACE59BA0E5AD90","parent":"BE7AE97E6B395E58E9FE79086"},{"tocTitle":"取消乘法","bolt":"BE58F96E6B688E4B998E6B395","parent":"BE7AE97E6B395E58E9FE79086"},{"tocTitle":"定点运算","bolt":"BE5AE9AE782B9E8BF90E7AE97","parent":"BE7AE97E6B395E58E9FE79086"}]},{"tocTitle":"CORDIC的推广","bolt":"BCORDICE79A84E68EA8E5B9BF","child":[{"tocTitle":"理论分析","bolt":"BE79086E8AEBAE58886E69E90","parent":"BCORDICE79A84E68EA8E5B9BF"},{"tocTitle":"两种旋转模式","bolt":"BE4B8A4E7A78DE6978BE8BDACE6A8A1E5BC8F","child":[{"tocTitle":"向量模式","bolt":"BE59091E9878FE6A8A1E5BC8F","parent":"BE4B8A4E7A78DE6978BE8BDACE6A8A1E5BC8F"},{"tocTitle":"旋转模式","bolt":"BE6978BE8BDACE6A8A1E5BC8F","parent":"BE4B8A4E7A78DE6978BE8BDACE6A8A1E5BC8F"}],"parent":"BCORDICE79A84E68EA8E5B9BF"},{"tocTitle":"正弦与余弦","bolt":"BE6ADA3E5BCA6E4B88EE4BD99E5BCA6","parent":"BCORDICE79A84E68EA8E5B9BF"},{"tocTitle":"反正切与向量的模","bolt":"BE58F8DE6ADA3E58887E4B88EE59091E9878FE79A84E6A8A1","parent":"BCORDICE79A84E68EA8E5B9BF"},{"tocTitle":"反正弦与反余弦","bolt":"BE58F8DE6ADA3E5BCA6E4B88EE58F8DE4BD99E5BCA6","parent":"BCORDICE79A84E68EA8E5B9BF"},{"tocTitle":"线性变换：乘与除","bolt":"BE7BABFE680A7E58F98E68DA2EFBC9AE4B998E4B88EE999A4","parent":"BCORDICE79A84E68EA8E5B9BF"},{"tocTitle":"双曲变换：开平方根","bolt":"BE58F8CE69BB2E58F98E68DA2EFBC9AE5BC80E5B9B3E696B9E6A0B9","parent":"BCORDICE79A84E68EA8E5B9BF"},{"tocTitle":"统一CORDIC","bolt":"BE7BB9FE4B880CORDIC","parent":"BCORDICE79A84E68EA8E5B9BF"}]},{"tocTitle":"误差分析","bolt":"BE8AFAFE5B7AEE58886E69E90"},{"tocTitle":"总结","bolt":"BE680BBE7BB93"}],"excerpt":["对于初等函数的计算，现在最常用的办法是泰勒展开、切比雪夫逼近等方法。计算精度是有的，但是全浮点的运算，在一些低廉的硬件系统之中仍然受到了很大的限制，邪道点的方法比如直接打表hash查找，虽然时间上达到了O(1)的效果，但是不可避免的会消耗大量的硬件空间，如果空间不够用的话，势必就需要外接储存器，但是MCU和外接储存器通信又要耗费时间，这又有点本末倒置了。那么，有没有折衷的方法呢？答案当然是有的，这就是本文要介绍的CRODIC算法，即坐标旋转数字计算。"],"next":{"path":"/post/amplifier-limit","title":"运放限幅电路"},"prev":{"path":"/post/bridge-rectifier","title":"单相桥式整流"},"content":"<p><span>CRODIC算法，即<em>坐标旋转数字计算(Coordinate Rotation Digital Computer)</em>，因为其简单的结构，只有移位累加的计算过程，不需要硬件乘法器，没有除法运算，而且CORDIC算法可以计算三角函数，双曲函数，开平方，自然对数等几乎所有的初等函数，纯硬件的实现非常简单，所以该算法被广泛的应用于FPGA平台上。这个算法尤其是在没有硬件乘法器，没有浮点运算单元，Flash空间也很捉急的小型系统中有很大的优势。</span></p><h1 id=\"BE7AE97E6B395E58E9FE79086\">算法原理</h1><p><span>CORDIC算法的核心其实就是对广义向量旋转进行迭代，由J.D.Volder于1959年首次提出，当时是用来进行三角函数计算的主要算法。1971年Walter.J提出了统一CORDIC算法，将线性和双曲线变换都包括进了CORDIC算法之中，形成目前所用到的CORDIC算法最基本的数学基础。</span></p><h2 id=\"BE59D90E6A087E6978BE8BDAC\">坐标旋转</h2><p><span><img class=\"img-block\" src=\"/img/algorithm-CRODIC/01.png\" alt=\"坐标旋转\" title=\"坐标旋转\"><span class=\"img-title\">图01　坐标旋转</span></span><span>坐标旋转，顾名思义就是将上图中的 <em>(x<sub>1</sub>, y<sub>1</sub>)</em> 旋转 <em>θ</em> 度之后到 <em>(x<sub>2</sub>, y<sub>2</sub>)</em> 的过程。求解过程很简单，这里就略过。解得：</span><span><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mrow><mo fence=\"true\">{</mo><mtable><mtr><mtd><mrow><msub><mi>x</mi><mn>2</mn></msub><mo>=</mo><msub><mi>x</mi><mn>1</mn></msub><mo>⋅</mo><mi>c</mi><mi>o</mi><mi>s</mi><mi>θ</mi><mo>+</mo><msub><mi>y</mi><mn>1</mn></msub><mo>⋅</mo><mi>s</mi><mi>i</mi><mi>n</mi><mi>θ</mi></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>y</mi><mn>2</mn></msub><mo>=</mo><msub><mi>x</mi><mn>1</mn></msub><mo>⋅</mo><mi>s</mi><mi>i</mi><mi>n</mi><mi>θ</mi><mo>−</mo><msub><mi>y</mi><mn>1</mn></msub><mo>⋅</mo><mi>c</mi><mi>o</mi><mi>s</mi><mi>θ</mi></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding=\"application/x-tex\">\\left\\{\\begin{matrix}</span><span>x_2=x_1\\cdot cos\\theta +y_1\\cdot sin\\theta\\\\</span><span>y_2=x_1\\cdot sin\\theta -y_1\\cdot cos\\theta</span><span>\\end{matrix}\\right.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"strut\" style=\"height:1.45em;\"></span><span class=\"strut bottom\" style=\"height:2.40003em;vertical-align:-0.95003em;\"></span><span class=\"base displaystyle textstyle uncramped\"><span class=\"minner displaystyle textstyle uncramped\"><span class=\"mopen style-wrap reset-textstyle textstyle uncramped\" style=\"top:0em;\"><span class=\"delimsizing size3\">{</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist\"><span style=\"top:-0.6099999999999999em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">2</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">1</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mord mathit\">c</span><span class=\"mord mathit\">o</span><span class=\"mord mathit\">s</span><span class=\"mord mathit\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mbin\">+</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">1</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mord mathit\">s</span><span class=\"mord mathit\">i</span><span class=\"mord mathit\">n</span><span class=\"mord mathit\" style=\"margin-right:0.02778em;\">θ</span></span></span><span style=\"top:0.5900000000000003em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">2</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">1</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mord mathit\">s</span><span class=\"mord mathit\">i</span><span class=\"mord mathit\">n</span><span class=\"mord mathit\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mbin\">−</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">1</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mord mathit\">c</span><span class=\"mord mathit\">o</span><span class=\"mord mathit\">s</span><span class=\"mord mathit\" style=\"margin-right:0.02778em;\">θ</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span><span class=\"mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span></span></span></span></span></span></span><span>为了方便分析，提出 <em>cosθ</em> 这个公因式，得到：</span><span><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mrow><mo fence=\"true\">{</mo><mtable><mtr><mtd><mrow><msub><mi>x</mi><mn>2</mn></msub><mo>=</mo><mi>c</mi><mi>o</mi><mi>s</mi><mi>θ</mi><mo>(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>y</mi><mn>1</mn></msub><mo>⋅</mo><mi>t</mi><mi>a</mi><mi>n</mi><mi>θ</mi><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>y</mi><mn>2</mn></msub><mo>=</mo><mi>c</mi><mi>o</mi><mi>s</mi><mi>θ</mi><mo>(</mo><msub><mi>y</mi><mn>1</mn></msub><mo>−</mo><msub><mi>x</mi><mn>1</mn></msub><mo>⋅</mo><mi>t</mi><mi>a</mi><mi>n</mi><mi>θ</mi><mo>)</mo></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding=\"application/x-tex\">\\left\\{\\begin{matrix}</span><span>x_2=cos\\theta(x_1+y_1\\cdot tan\\theta)\\\\</span><span>y_2=cos\\theta(y_1-x_1\\cdot tan\\theta)</span><span>\\end{matrix}\\right.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"strut\" style=\"height:1.45em;\"></span><span class=\"strut bottom\" style=\"height:2.40003em;vertical-align:-0.95003em;\"></span><span class=\"base displaystyle textstyle uncramped\"><span class=\"minner displaystyle textstyle uncramped\"><span class=\"mopen style-wrap reset-textstyle textstyle uncramped\" style=\"top:0em;\"><span class=\"delimsizing size3\">{</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist\"><span style=\"top:-0.6099999999999999em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">2</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord mathit\">c</span><span class=\"mord mathit\">o</span><span class=\"mord mathit\">s</span><span class=\"mord mathit\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">1</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">+</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">1</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mord mathit\">t</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">n</span><span class=\"mord mathit\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mclose\">)</span></span></span><span style=\"top:0.5900000000000003em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">2</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord mathit\">c</span><span class=\"mord mathit\">o</span><span class=\"mord mathit\">s</span><span class=\"mord mathit\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">1</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">−</span><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">1</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mord mathit\">t</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">n</span><span class=\"mord mathit\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mclose\">)</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span><span class=\"mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span></span></span></span></span></span></span></p><h2 id=\"BE4BA8CE58886E69FA5E689BE\">二分查找</h2><p><span><img class=\"img-block\" src=\"/img/algorithm-CRODIC/02.png\" alt=\"求θ的值\" title=\"求θ的值\"><span class=\"img-title\">图02　求θ的值</span></span><span>二分查找是计算机之中非常有名的算法了，简而言之就是每次都折半进行查找，能够达到O(logn)的时间复杂度，在这里使用二分查找是为了找寻旋转的角度。</span></p><p><span>为了简单分析，我们只讨论在第一象限的情况，也就是 <em>x &gt; 0 且 y &gt; 0</em> 的情况。</span><span>那么很明显的有，<span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>θ</mi><mo>=</mo><mi>a</mi><mi>r</mi><mi>c</mi><mi>t</mi><mi>a</mi><mi>n</mi><mo>(</mo><mfrac><mrow><mi>y</mi></mrow><mrow><mi>x</mi></mrow></mfrac><mo>)</mo></mrow><annotation encoding=\"application/x-tex\">\\theta=arctan(\\frac{y}{x})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"strut\" style=\"height:0.75em;\"></span><span class=\"strut bottom\" style=\"height:1.095em;vertical-align:-0.345em;\"></span><span class=\"base textstyle uncramped\"><span class=\"mord mathit\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mrel\">=</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathit\">c</span><span class=\"mord mathit\">t</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">n</span><span class=\"mopen\">(</span><span class=\"mord reset-textstyle textstyle uncramped\"><span class=\"mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist\"><span style=\"top:0.345em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">x</span></span></span></span><span style=\"top:-0.22999999999999998em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle textstyle uncramped frac-line\"></span></span><span style=\"top:-0.44610799999999995em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle uncramped mtight\"><span class=\"mord scriptstyle uncramped mtight\"><span class=\"mord mathit mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span><span class=\"mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span></span><span class=\"mclose\">)</span></span></span></span>。</span></p><p><span>CORDIC的思想非常直接，那就是说如果我们把向量 <em>(x, y)</em> 进行旋转，当旋转到 <em>y = 0</em> 的时候，旋转的角度就是 <em>θ</em> 了。</span><span>但是，要如何进行旋转呢？在这里，我们换一个方向来看，实际上 <em>(0°, 90°)</em> 我们可以看作是一个有序的序列，边界条件是 <em>y → 0</em> ，这完全符合二分查找的使用范围。</span><span>利用二分查找的思想，我们可以先让向量顺时针旋转 <em>45°</em> ，代入旋转方程中，得到：</span><span><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mrow><mo fence=\"true\">{</mo><mtable><mtr><mtd><mrow><msup><mi>x</mi><mrow><mi mathvariant=\"normal\">′</mi></mrow></msup><mo>=</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo>(</mo><mn>4</mn><msup><mn>5</mn><mo>∘</mo></msup><mo>)</mo><mo>(</mo><mn>2</mn><mo>+</mo><mn>3</mn><mo>⋅</mo><mi>t</mi><mi>a</mi><mi>n</mi><mo>(</mo><mn>4</mn><msup><mn>5</mn><mo>∘</mo></msup><mo>)</mo><mo>)</mo><mo>=</mo><mn>3</mn><mi mathvariant=\"normal\">.</mi><mn>5</mn><mn>3</mn><mn>5</mn><mn>5</mn></mrow></mtd></mtr><mtr><mtd><mrow><msup><mi>y</mi><mrow><mi mathvariant=\"normal\">′</mi></mrow></msup><mo>=</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo>(</mo><mn>4</mn><msup><mn>5</mn><mo>∘</mo></msup><mo>)</mo><mo>(</mo><mn>3</mn><mo>−</mo><mn>2</mn><mo>⋅</mo><mi>t</mi><mi>a</mi><mi>n</mi><mo>(</mo><mn>4</mn><msup><mn>5</mn><mo>∘</mo></msup><mo>)</mo><mo>)</mo><mo>=</mo><mn>0</mn><mi mathvariant=\"normal\">.</mi><mn>7</mn><mn>0</mn><mn>7</mn><mn>1</mn></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding=\"application/x-tex\">\\left\\{\\begin{matrix}</span><span>x&#x27;=cos(45^\\circ)(2+3\\cdot tan(45^\\circ))=3.5355\\\\</span><span>y&#x27;=cos(45^\\circ)(3-2\\cdot tan(45^\\circ))=0.7071</span><span>\\end{matrix}\\right.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"strut\" style=\"height:1.45em;\"></span><span class=\"strut bottom\" style=\"height:2.40003em;vertical-align:-0.95003em;\"></span><span class=\"base displaystyle textstyle uncramped\"><span class=\"minner displaystyle textstyle uncramped\"><span class=\"mopen style-wrap reset-textstyle textstyle uncramped\" style=\"top:0em;\"><span class=\"delimsizing size3\">{</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist\"><span style=\"top:-0.6099999999999999em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:-0.413em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle uncramped mtight\"><span class=\"mord scriptstyle uncramped mtight\"><span class=\"mord mathrm mtight\">′</span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord mathit\">c</span><span class=\"mord mathit\">o</span><span class=\"mord mathit\">s</span><span class=\"mopen\">(</span><span class=\"mord mathrm\">4</span><span class=\"mord\"><span class=\"mord mathrm\">5</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:-0.413em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle uncramped mtight\"><span class=\"mbin mtight\">∘</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord mathrm\">2</span><span class=\"mbin\">+</span><span class=\"mord mathrm\">3</span><span class=\"mbin\">⋅</span><span class=\"mord mathit\">t</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">n</span><span class=\"mopen\">(</span><span class=\"mord mathrm\">4</span><span class=\"mord\"><span class=\"mord mathrm\">5</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:-0.413em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle uncramped mtight\"><span class=\"mbin mtight\">∘</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\">)</span><span class=\"mrel\">=</span><span class=\"mord mathrm\">3</span><span class=\"mord mathrm\">.</span><span class=\"mord mathrm\">5</span><span class=\"mord mathrm\">3</span><span class=\"mord mathrm\">5</span><span class=\"mord mathrm\">5</span></span></span><span style=\"top:0.5900000000000003em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:-0.413em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle uncramped mtight\"><span class=\"mord scriptstyle uncramped mtight\"><span class=\"mord mathrm mtight\">′</span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord mathit\">c</span><span class=\"mord mathit\">o</span><span class=\"mord mathit\">s</span><span class=\"mopen\">(</span><span class=\"mord mathrm\">4</span><span class=\"mord\"><span class=\"mord mathrm\">5</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:-0.413em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle uncramped mtight\"><span class=\"mbin mtight\">∘</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord mathrm\">3</span><span class=\"mbin\">−</span><span class=\"mord mathrm\">2</span><span class=\"mbin\">⋅</span><span class=\"mord mathit\">t</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">n</span><span class=\"mopen\">(</span><span class=\"mord mathrm\">4</span><span class=\"mord\"><span class=\"mord mathrm\">5</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:-0.413em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle uncramped mtight\"><span class=\"mbin mtight\">∘</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\">)</span><span class=\"mrel\">=</span><span class=\"mord mathrm\">0</span><span class=\"mord mathrm\">.</span><span class=\"mord mathrm\">7</span><span class=\"mord mathrm\">0</span><span class=\"mord mathrm\">7</span><span class=\"mord mathrm\">1</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span><span class=\"mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span></span></span></span></span></span></span><span>可以看到这个时候我们可以发现此时 <em>y &gt; 0</em> ，说明旋转的角度不够，所以继续顺时针旋转，不过这次是旋转 <em>45°/2 = 22.5°</em> :</span><span><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mrow><mo fence=\"true\">{</mo><mtable><mtr><mtd><mrow><msup><mi>x</mi><mrow><mi mathvariant=\"normal\">′</mi></mrow></msup><mo>=</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo>(</mo><mn>2</mn><mn>2</mn><mi mathvariant=\"normal\">.</mi><msup><mn>5</mn><mo>∘</mo></msup><mo>)</mo><mo>(</mo><mn>3</mn><mi mathvariant=\"normal\">.</mi><mn>5</mn><mn>3</mn><mn>5</mn><mn>5</mn><mo>+</mo><mn>0</mn><mi mathvariant=\"normal\">.</mi><mn>7</mn><mn>0</mn><mn>7</mn><mn>1</mn><mo>⋅</mo><mi>t</mi><mi>a</mi><mi>n</mi><mo>(</mo><mn>2</mn><mn>2</mn><mi mathvariant=\"normal\">.</mi><msup><mn>5</mn><mo>∘</mo></msup><mo>)</mo><mo>)</mo><mo>=</mo><mn>3</mn><mi mathvariant=\"normal\">.</mi><mn>5</mn><mn>3</mn><mn>7</mn><mn>0</mn></mrow></mtd></mtr><mtr><mtd><mrow><msup><mi>y</mi><mrow><mi mathvariant=\"normal\">′</mi></mrow></msup><mo>=</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo>(</mo><mn>2</mn><mn>2</mn><mi mathvariant=\"normal\">.</mi><msup><mn>5</mn><mo>∘</mo></msup><mo>)</mo><mo>(</mo><mn>0</mn><mi mathvariant=\"normal\">.</mi><mn>7</mn><mn>0</mn><mn>7</mn><mn>1</mn><mo>−</mo><mn>3</mn><mi mathvariant=\"normal\">.</mi><mn>5</mn><mn>3</mn><mn>5</mn><mn>5</mn><mo>⋅</mo><mi>t</mi><mi>a</mi><mi>n</mi><mo>(</mo><mn>2</mn><mn>2</mn><mi mathvariant=\"normal\">.</mi><msup><mn>5</mn><mo>∘</mo></msup><mo>)</mo><mo>)</mo><mo>=</mo><mo>−</mo><mn>0</mn><mi mathvariant=\"normal\">.</mi><mn>6</mn><mn>9</mn><mn>9</mn><mn>7</mn></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding=\"application/x-tex\">\\left\\{\\begin{matrix}</span><span>x&#x27;=cos(22.5^\\circ)(3.5355+0.7071\\cdot tan(22.5^\\circ))=3.5370\\\\</span><span>y&#x27;=cos(22.5^\\circ)(0.7071-3.5355\\cdot tan(22.5^\\circ))=-0.6997</span><span>\\end{matrix}\\right.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"strut\" style=\"height:1.45em;\"></span><span class=\"strut bottom\" style=\"height:2.40003em;vertical-align:-0.95003em;\"></span><span class=\"base displaystyle textstyle uncramped\"><span class=\"minner displaystyle textstyle uncramped\"><span class=\"mopen style-wrap reset-textstyle textstyle uncramped\" style=\"top:0em;\"><span class=\"delimsizing size3\">{</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist\"><span style=\"top:-0.6099999999999999em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:-0.413em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle uncramped mtight\"><span class=\"mord scriptstyle uncramped mtight\"><span class=\"mord mathrm mtight\">′</span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord mathit\">c</span><span class=\"mord mathit\">o</span><span class=\"mord mathit\">s</span><span class=\"mopen\">(</span><span class=\"mord mathrm\">2</span><span class=\"mord mathrm\">2</span><span class=\"mord mathrm\">.</span><span class=\"mord\"><span class=\"mord mathrm\">5</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:-0.413em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle uncramped mtight\"><span class=\"mbin mtight\">∘</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord mathrm\">3</span><span class=\"mord mathrm\">.</span><span class=\"mord mathrm\">5</span><span class=\"mord mathrm\">3</span><span class=\"mord mathrm\">5</span><span class=\"mord mathrm\">5</span><span class=\"mbin\">+</span><span class=\"mord mathrm\">0</span><span class=\"mord mathrm\">.</span><span class=\"mord mathrm\">7</span><span class=\"mord mathrm\">0</span><span class=\"mord mathrm\">7</span><span class=\"mord mathrm\">1</span><span class=\"mbin\">⋅</span><span class=\"mord mathit\">t</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">n</span><span class=\"mopen\">(</span><span class=\"mord mathrm\">2</span><span class=\"mord mathrm\">2</span><span class=\"mord mathrm\">.</span><span class=\"mord\"><span class=\"mord mathrm\">5</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:-0.413em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle uncramped mtight\"><span class=\"mbin mtight\">∘</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\">)</span><span class=\"mrel\">=</span><span class=\"mord mathrm\">3</span><span class=\"mord mathrm\">.</span><span class=\"mord mathrm\">5</span><span class=\"mord mathrm\">3</span><span class=\"mord mathrm\">7</span><span class=\"mord mathrm\">0</span></span></span><span style=\"top:0.5900000000000003em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:-0.413em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle uncramped mtight\"><span class=\"mord scriptstyle uncramped mtight\"><span class=\"mord mathrm mtight\">′</span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord mathit\">c</span><span class=\"mord mathit\">o</span><span class=\"mord mathit\">s</span><span class=\"mopen\">(</span><span class=\"mord mathrm\">2</span><span class=\"mord mathrm\">2</span><span class=\"mord mathrm\">.</span><span class=\"mord\"><span class=\"mord mathrm\">5</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:-0.413em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle uncramped mtight\"><span class=\"mbin mtight\">∘</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord mathrm\">0</span><span class=\"mord mathrm\">.</span><span class=\"mord mathrm\">7</span><span class=\"mord mathrm\">0</span><span class=\"mord mathrm\">7</span><span class=\"mord mathrm\">1</span><span class=\"mbin\">−</span><span class=\"mord mathrm\">3</span><span class=\"mord mathrm\">.</span><span class=\"mord mathrm\">5</span><span class=\"mord mathrm\">3</span><span class=\"mord mathrm\">5</span><span class=\"mord mathrm\">5</span><span class=\"mbin\">⋅</span><span class=\"mord mathit\">t</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">n</span><span class=\"mopen\">(</span><span class=\"mord mathrm\">2</span><span class=\"mord mathrm\">2</span><span class=\"mord mathrm\">.</span><span class=\"mord\"><span class=\"mord mathrm\">5</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:-0.413em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle uncramped mtight\"><span class=\"mbin mtight\">∘</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\">)</span><span class=\"mrel\">=</span><span class=\"mord\">−</span><span class=\"mord mathrm\">0</span><span class=\"mord mathrm\">.</span><span class=\"mord mathrm\">6</span><span class=\"mord mathrm\">9</span><span class=\"mord mathrm\">9</span><span class=\"mord mathrm\">7</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span><span class=\"mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span></span></span></span></span></span></span><span>现在一共旋转了 <em>45° + 22.5° = 67.5°</em> 。可以看到看到此时 <em>y &lt; 0</em> ，说明已经转过头了，现在我们可以逆时针旋转，旋转的角度为 <em>22.5°/2 = 11.25°</em> ：</span><span><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mrow><mo fence=\"true\">{</mo><mtable><mtr><mtd><mrow><msup><mi>x</mi><mrow><mi mathvariant=\"normal\">′</mi></mrow></msup><mo>=</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo>(</mo><mn>1</mn><mn>1</mn><mi mathvariant=\"normal\">.</mi><mn>2</mn><msup><mn>5</mn><mo>∘</mo></msup><mo>)</mo><mo>(</mo><mn>3</mn><mi mathvariant=\"normal\">.</mi><mn>5</mn><mn>3</mn><mn>7</mn><mn>0</mn><mo>−</mo><mo>(</mo><mo>−</mo><mn>0</mn><mi mathvariant=\"normal\">.</mi><mn>6</mn><mn>9</mn><mn>9</mn><mn>7</mn><mo>)</mo><mo>⋅</mo><mi>t</mi><mi>a</mi><mi>n</mi><mo>(</mo><mn>1</mn><mn>1</mn><mi mathvariant=\"normal\">.</mi><mn>2</mn><msup><mn>5</mn><mo>∘</mo></msup><mo>)</mo><mo>)</mo><mo>=</mo><mn>3</mn><mi mathvariant=\"normal\">.</mi><mn>6</mn><mn>0</mn><mn>5</mn><mn>5</mn></mrow></mtd></mtr><mtr><mtd><mrow><msup><mi>y</mi><mrow><mi mathvariant=\"normal\">′</mi></mrow></msup><mo>=</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo>(</mo><mn>1</mn><mn>1</mn><mi mathvariant=\"normal\">.</mi><mn>2</mn><msup><mn>5</mn><mo>∘</mo></msup><mo>)</mo><mo>(</mo><mo>−</mo><mn>0</mn><mi mathvariant=\"normal\">.</mi><mn>6</mn><mn>9</mn><mn>9</mn><mn>7</mn><mo>+</mo><mn>3</mn><mi mathvariant=\"normal\">.</mi><mn>5</mn><mn>3</mn><mn>7</mn><mn>0</mn><mo>⋅</mo><mi>t</mi><mi>a</mi><mi>n</mi><mo>(</mo><mn>1</mn><mn>1</mn><mi mathvariant=\"normal\">.</mi><mn>2</mn><msup><mn>5</mn><mo>∘</mo></msup><mo>)</mo><mo>)</mo><mo>=</mo><mn>0</mn><mi mathvariant=\"normal\">.</mi><mn>0</mn><mn>0</mn><mn>3</mn><mn>8</mn></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding=\"application/x-tex\">\\left\\{\\begin{matrix}</span><span>x&#x27;=cos(11.25^\\circ)(3.5370-(-0.6997)\\cdot tan(11.25^\\circ))=3.6055\\\\ </span><span>y&#x27;=cos(11.25^\\circ)(-0.6997+3.5370\\cdot tan(11.25^\\circ))=0.0038</span><span>\\end{matrix}\\right.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"strut\" style=\"height:1.45em;\"></span><span class=\"strut bottom\" style=\"height:2.40003em;vertical-align:-0.95003em;\"></span><span class=\"base displaystyle textstyle uncramped\"><span class=\"minner displaystyle textstyle uncramped\"><span class=\"mopen style-wrap reset-textstyle textstyle uncramped\" style=\"top:0em;\"><span class=\"delimsizing size3\">{</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist\"><span style=\"top:-0.6099999999999999em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:-0.413em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle uncramped mtight\"><span class=\"mord scriptstyle uncramped mtight\"><span class=\"mord mathrm mtight\">′</span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord mathit\">c</span><span class=\"mord mathit\">o</span><span class=\"mord mathit\">s</span><span class=\"mopen\">(</span><span class=\"mord mathrm\">1</span><span class=\"mord mathrm\">1</span><span class=\"mord mathrm\">.</span><span class=\"mord mathrm\">2</span><span class=\"mord\"><span class=\"mord mathrm\">5</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:-0.413em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle uncramped mtight\"><span class=\"mbin mtight\">∘</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord mathrm\">3</span><span class=\"mord mathrm\">.</span><span class=\"mord mathrm\">5</span><span class=\"mord mathrm\">3</span><span class=\"mord mathrm\">7</span><span class=\"mord mathrm\">0</span><span class=\"mbin\">−</span><span class=\"mopen\">(</span><span class=\"mord\">−</span><span class=\"mord mathrm\">0</span><span class=\"mord mathrm\">.</span><span class=\"mord mathrm\">6</span><span class=\"mord mathrm\">9</span><span class=\"mord mathrm\">9</span><span class=\"mord mathrm\">7</span><span class=\"mclose\">)</span><span class=\"mbin\">⋅</span><span class=\"mord mathit\">t</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">n</span><span class=\"mopen\">(</span><span class=\"mord mathrm\">1</span><span class=\"mord mathrm\">1</span><span class=\"mord mathrm\">.</span><span class=\"mord mathrm\">2</span><span class=\"mord\"><span class=\"mord mathrm\">5</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:-0.413em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle uncramped mtight\"><span class=\"mbin mtight\">∘</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\">)</span><span class=\"mrel\">=</span><span class=\"mord mathrm\">3</span><span class=\"mord mathrm\">.</span><span class=\"mord mathrm\">6</span><span class=\"mord mathrm\">0</span><span class=\"mord mathrm\">5</span><span class=\"mord mathrm\">5</span></span></span><span style=\"top:0.5900000000000003em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:-0.413em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle uncramped mtight\"><span class=\"mord scriptstyle uncramped mtight\"><span class=\"mord mathrm mtight\">′</span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord mathit\">c</span><span class=\"mord mathit\">o</span><span class=\"mord mathit\">s</span><span class=\"mopen\">(</span><span class=\"mord mathrm\">1</span><span class=\"mord mathrm\">1</span><span class=\"mord mathrm\">.</span><span class=\"mord mathrm\">2</span><span class=\"mord\"><span class=\"mord mathrm\">5</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:-0.413em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle uncramped mtight\"><span class=\"mbin mtight\">∘</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord\">−</span><span class=\"mord mathrm\">0</span><span class=\"mord mathrm\">.</span><span class=\"mord mathrm\">6</span><span class=\"mord mathrm\">9</span><span class=\"mord mathrm\">9</span><span class=\"mord mathrm\">7</span><span class=\"mbin\">+</span><span class=\"mord mathrm\">3</span><span class=\"mord mathrm\">.</span><span class=\"mord mathrm\">5</span><span class=\"mord mathrm\">3</span><span class=\"mord mathrm\">7</span><span class=\"mord mathrm\">0</span><span class=\"mbin\">⋅</span><span class=\"mord mathit\">t</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">n</span><span class=\"mopen\">(</span><span class=\"mord mathrm\">1</span><span class=\"mord mathrm\">1</span><span class=\"mord mathrm\">.</span><span class=\"mord mathrm\">2</span><span class=\"mord\"><span class=\"mord mathrm\">5</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:-0.413em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle uncramped mtight\"><span class=\"mbin mtight\">∘</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\">)</span><span class=\"mrel\">=</span><span class=\"mord mathrm\">0</span><span class=\"mord mathrm\">.</span><span class=\"mord mathrm\">0</span><span class=\"mord mathrm\">0</span><span class=\"mord mathrm\">3</span><span class=\"mord mathrm\">8</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span><span class=\"mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span></span></span></span></span></span></span><span>到现在一共旋转了 <em>67.5° - 11.25° = 56.25°</em> ，可以看到 <em>y</em> 已经非常接近于 <em>0</em> 了，接下来的过程与之类似，就不再演算了。</span></p><p class=\"note\"><span><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>a</mi><mi>r</mi><mi>c</mi><mi>t</mi><mi>a</mi><mi>n</mi><mo>(</mo><mn>3</mn><mi mathvariant=\"normal\">/</mi><mn>2</mn><mo>)</mo><mo>=</mo><mn>5</mn><mn>6</mn><mi mathvariant=\"normal\">.</mi><mn>3</mn><msup><mn>1</mn><mo>∘</mo></msup></mrow><annotation encoding=\"application/x-tex\">arctan(3/2)=56.31^\\circ</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"strut\" style=\"height:0.75em;\"></span><span class=\"strut bottom\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"base textstyle uncramped\"><span class=\"mord mathit\">a</span><span class=\"mord mathit\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathit\">c</span><span class=\"mord mathit\">t</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">n</span><span class=\"mopen\">(</span><span class=\"mord mathrm\">3</span><span class=\"mord mathrm\">/</span><span class=\"mord mathrm\">2</span><span class=\"mclose\">)</span><span class=\"mrel\">=</span><span class=\"mord mathrm\">5</span><span class=\"mord mathrm\">6</span><span class=\"mord mathrm\">.</span><span class=\"mord mathrm\">3</span><span class=\"mord\"><span class=\"mord mathrm\">1</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:-0.363em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle uncramped mtight\"><span class=\"mbin mtight\">∘</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span></span></span></span></p><p><span>可以发现上面的过程都是重复运算，那当然可以直接写成代码，下面是C语言的实现：</span></p><pre class=\"c\"><code><ul class=\"gutter\"><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li><li>11</li><li>12</li><li>13</li><li>14</li><li>15</li><li>16</li><li>17</li><li>18</li><li>19</li><li>20</li><li>21</li><li>22</li><li>23</li><li>24</li><li>25</li><li>26</li><li>27</li><li>28</li><li>29</li><li>30</li><li>31</li></ul><ul class=\"code\"><li><span class=\"hljs-keyword\">int</span> i;</li><li><span class=\"hljs-keyword\">float</span> x = <span class=\"hljs-number\">2.0</span>;</li><li><span class=\"hljs-keyword\">float</span> y = <span class=\"hljs-number\">3.0</span>;</li><li><span class=\"hljs-keyword\">float</span> anglesum = <span class=\"hljs-number\">0.0</span>;</li><li><span class=\"hljs-keyword\">float</span> pi = <span class=\"hljs-number\">3.141592654</span>;</li><li><span class=\"hljs-keyword\">float</span> angle = <span class=\"hljs-number\">45.0</span>/<span class=\"hljs-number\">180</span>*pi;</li><li></li><li><span class=\"hljs-keyword\">for</span>(i = <span class=\"hljs-number\">0</span>; i &lt; <span class=\"hljs-number\">15</span>; i++)</li><li>{</li><li>    <span class=\"hljs-keyword\">if</span>(y &lt; <span class=\"hljs-number\">0</span>)</li><li>    {</li><li>        x_new = <span class=\"hljs-built_in\">cos</span>(angle)*(x - y*<span class=\"hljs-built_in\">tan</span>(angle));</li><li>        y_new = <span class=\"hljs-built_in\">cos</span>(angle)*(y + x*<span class=\"hljs-built_in\">tan</span>(angle));</li><li>        x = x_new;</li><li>        y = y_new;</li><li>        anglesum -= angle;</li><li>    }</li><li>    <span class=\"hljs-keyword\">else</span></li><li>    {</li><li>        x_new = <span class=\"hljs-built_in\">cos</span>(angle)*(x + y*<span class=\"hljs-built_in\">tan</span>(angle));</li><li>        y_new = <span class=\"hljs-built_in\">cos</span>(angle)*(y - x*<span class=\"hljs-built_in\">tan</span>(angle));</li><li>        x = x_new;</li><li>        y = y_new;</li><li>        anglesum += angle;</li><li>    }</li><li>    angle /= <span class=\"hljs-number\">2</span>;</li><li>}</li><li>anglesum=anglesum*<span class=\"hljs-number\">180</span>/pi;</li><li><span class=\"hljs-built_in\">printf</span>(<span class=\"hljs-string\">\"The ans is %f\\n.\"</span>,anglesum);</li><li></li><li><span class=\"hljs-comment\">//The ans is 56.307678.</span></li></ul></code></pre><h2 id=\"BE58EBBE999A4E585ACE59BA0E5AD90\">去除公因子</h2><p><span>CORDIC算法的雏形已经有了，但是这个算法实际上非常低效，因为每次迭代都有4次乘法，运算量还是太大了。必须要进行改进。我们再来看看坐标旋转的公式：</span><span><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mrow><mo fence=\"true\">{</mo><mtable><mtr><mtd><mrow><msub><mi>x</mi><mn>2</mn></msub><mo>=</mo><mi>c</mi><mi>o</mi><mi>s</mi><mi>θ</mi><mo>(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>y</mi><mn>1</mn></msub><mo>⋅</mo><mi>t</mi><mi>a</mi><mi>n</mi><mi>θ</mi><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>y</mi><mn>2</mn></msub><mo>=</mo><mi>c</mi><mi>o</mi><mi>s</mi><mi>θ</mi><mo>(</mo><msub><mi>y</mi><mn>1</mn></msub><mo>−</mo><msub><mi>x</mi><mn>1</mn></msub><mo>⋅</mo><mi>t</mi><mi>a</mi><mi>n</mi><mi>θ</mi><mo>)</mo></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding=\"application/x-tex\">\\left\\{\\begin{matrix}</span><span>x_2=cos\\theta(x_1+y_1\\cdot tan\\theta)\\\\</span><span>y_2=cos\\theta(y_1-x_1\\cdot tan\\theta)</span><span>\\end{matrix}\\right.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"strut\" style=\"height:1.45em;\"></span><span class=\"strut bottom\" style=\"height:2.40003em;vertical-align:-0.95003em;\"></span><span class=\"base displaystyle textstyle uncramped\"><span class=\"minner displaystyle textstyle uncramped\"><span class=\"mopen style-wrap reset-textstyle textstyle uncramped\" style=\"top:0em;\"><span class=\"delimsizing size3\">{</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist\"><span style=\"top:-0.6099999999999999em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">2</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord mathit\">c</span><span class=\"mord mathit\">o</span><span class=\"mord mathit\">s</span><span class=\"mord mathit\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">1</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">+</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">1</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mord mathit\">t</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">n</span><span class=\"mord mathit\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mclose\">)</span></span></span><span style=\"top:0.5900000000000003em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">2</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord mathit\">c</span><span class=\"mord mathit\">o</span><span class=\"mord mathit\">s</span><span class=\"mord mathit\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">1</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">−</span><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">1</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mord mathit\">t</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">n</span><span class=\"mord mathit\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mclose\">)</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span><span class=\"mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span></span></span></span></span></span></span><span>每次旋转，x和y都会乘以一个 <em>cos(θ)</em> ，但是实际上我们要求的是<span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>a</mi><mi>r</mi><mi>c</mi><mi>t</mi><mi>a</mi><mi>n</mi><mo>(</mo><mfrac><mrow><mi>y</mi></mrow><mrow><mi>x</mi></mrow></mfrac><mo>)</mo></mrow><annotation encoding=\"application/x-tex\">arctan(\\frac{y}{x})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"strut\" style=\"height:0.75em;\"></span><span class=\"strut bottom\" style=\"height:1.095em;vertical-align:-0.345em;\"></span><span class=\"base textstyle uncramped\"><span class=\"mord mathit\">a</span><span class=\"mord mathit\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathit\">c</span><span class=\"mord mathit\">t</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">n</span><span class=\"mopen\">(</span><span class=\"mord reset-textstyle textstyle uncramped\"><span class=\"mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist\"><span style=\"top:0.345em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">x</span></span></span></span><span style=\"top:-0.22999999999999998em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle textstyle uncramped frac-line\"></span></span><span style=\"top:-0.44610799999999995em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle uncramped mtight\"><span class=\"mord scriptstyle uncramped mtight\"><span class=\"mord mathit mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span><span class=\"mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span></span><span class=\"mclose\">)</span></span></span></span>。可以看到<span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mfrac><mrow><mi>y</mi></mrow><mrow><mi>x</mi></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">\\frac{y}{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"strut\" style=\"height:0.7475em;\"></span><span class=\"strut bottom\" style=\"height:1.0925em;vertical-align:-0.345em;\"></span><span class=\"base textstyle uncramped\"><span class=\"mord reset-textstyle textstyle uncramped\"><span class=\"mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist\"><span style=\"top:0.345em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">x</span></span></span></span><span style=\"top:-0.22999999999999998em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle textstyle uncramped frac-line\"></span></span><span style=\"top:-0.44610799999999995em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle uncramped mtight\"><span class=\"mord scriptstyle uncramped mtight\"><span class=\"mord mathit mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span><span class=\"mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span></span></span></span></span>的分子分母都含有 <em>cos(θ)</em> ，这个因式被约掉了。那么，我们也完全可以在计算中就直接不计算 <em>cos(θ)</em> ，得到：</span><span><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mrow><mo fence=\"true\">{</mo><mtable><mtr><mtd><mrow><msub><mover accent=\"true\"><mrow><mi>x</mi></mrow><mo>^</mo></mover><mn>2</mn></msub><mo>=</mo><msub><mi>x</mi><mn>1</mn></msub><mo>−</mo><msub><mi>y</mi><mn>1</mn></msub><mo>⋅</mo><mi>t</mi><mi>a</mi><mi>n</mi><mi>θ</mi></mrow></mtd></mtr><mtr><mtd><mrow><msub><mover accent=\"true\"><mrow><mi>y</mi></mrow><mo>^</mo></mover><mn>2</mn></msub><mo>=</mo><msub><mi>y</mi><mn>1</mn></msub><mo>+</mo><msub><mi>x</mi><mn>1</mn></msub><mo>⋅</mo><mi>t</mi><mi>a</mi><mi>n</mi><mi>θ</mi></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding=\"application/x-tex\">\\left\\{\\begin{matrix}</span><span>\\hat{x}_2=x_1-y_1\\cdot tan\\theta\\\\</span><span>\\hat{y}_2=y_1+x_1\\cdot tan\\theta</span><span>\\end{matrix}\\right.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"strut\" style=\"height:1.45em;\"></span><span class=\"strut bottom\" style=\"height:2.40003em;vertical-align:-0.95003em;\"></span><span class=\"base displaystyle textstyle uncramped\"><span class=\"minner displaystyle textstyle uncramped\"><span class=\"mopen style-wrap reset-textstyle textstyle uncramped\" style=\"top:0em;\"><span class=\"delimsizing size3\">{</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist\"><span style=\"top:-0.6099999999999999em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist\"><span style=\"top:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle cramped\"><span class=\"mord mathit\">x</span></span></span><span style=\"top:0em;margin-left:0.05556em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"accent-body\"><span>^</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">2</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">1</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">−</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">1</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mord mathit\">t</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">n</span><span class=\"mord mathit\" style=\"margin-right:0.02778em;\">θ</span></span></span><span style=\"top:0.5900000000000003em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist\"><span style=\"top:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle cramped\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span></span></span><span style=\"top:0em;margin-left:0.11112em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"accent-body\"><span>^</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">2</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">1</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">+</span><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">1</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mord mathit\">t</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">n</span><span class=\"mord mathit\" style=\"margin-right:0.02778em;\">θ</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span><span class=\"mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span></span></span></span></span></span></span><span>很明显的，现在式子中的向量<span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mo>(</mo><msub><mover accent=\"true\"><mrow><mi>x</mi></mrow><mo>^</mo></mover><mn>2</mn></msub><mo separator=\"true\">,</mo><msub><mover accent=\"true\"><mrow><mi>y</mi></mrow><mo>^</mo></mover><mn>2</mn></msub><mo>)</mo></mrow><annotation encoding=\"application/x-tex\">(\\hat{x}_2,\\hat{y}_2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"strut\" style=\"height:0.75em;\"></span><span class=\"strut bottom\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"base textstyle uncramped\"><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist\"><span style=\"top:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord textstyle cramped\"><span class=\"mord mathit\">x</span></span></span><span style=\"top:0em;margin-left:0.05556em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"accent-body\"><span>^</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">2</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mpunct\">,</span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist\"><span style=\"top:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord textstyle cramped\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span></span></span><span style=\"top:0em;margin-left:0.11112em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"accent-body\"><span>^</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">2</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mclose\">)</span></span></span></span>与原来的向量<span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mo>(</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><msub><mi>y</mi><mn>2</mn></msub><mo>)</mo></mrow><annotation encoding=\"application/x-tex\">(x_2,y_2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"strut\" style=\"height:0.75em;\"></span><span class=\"strut bottom\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"base textstyle uncramped\"><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">2</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mpunct\">,</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">2</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mclose\">)</span></span></span></span>是共线的，仅仅是在长度上会有差异。</span></p><h2 id=\"BE58F96E6B688E4B998E6B395\">取消乘法</h2><p><span>每次迭代的乘法已经减少了一半，还有没有别的方法呢？</span><span>第一次迭代的时候 <em>tan(45°) = 1</em> ，这是完全不需要乘法的。</span><span>第二次迭代的时候呢？ <em>tan(22.5°) = 0.41421</em> ，很不幸，这是一个小数，小数的乘法运算是不可避免的。但是我们可以看到这个数字很接近于0.5，要是这个数字是0.5的话，一个数乘以0.5，其实就是相当于将这个数右移一位。而单纯的移位操作是非常快速的。而0.5的话， <em>arctan(0.5) = 26.565</em> ，这个角度比22.5°稍大，这会影响二分查找的效率，但是对于提高运算速度而言绝对是利大于弊的。</span><span>类似的，我们可以在第三次迭代中使用 <em>arctan(0.25) = 14.0362°</em> ，同时乘数右移两位。</span><span>此时，我们已经消除了乘法运算了，但是运算中还有一个 <em>tan</em> 运算，仔细观察我们可以发现，每次迭代我们使用的 <em>tan</em> 的值都是固定的，所以我们完全可以使用函数表的方法来消灭它。</span></p><h2 id=\"BE5AE9AE782B9E8BF90E7AE97\">定点运算</h2><p><span>定点运算其实就是整数运算，只是需要另外一个数字来进行“定标”，也就是标明小数点在哪一位。也可以理解为通过一个系数将所有的数字放大至整数，用整型进行运算。</span><span>在这里我们将角度标定为定点整数，放大256倍。那么对应下来的理论精度就是 <em>1/256° = 0.00390625°</em> 。在大多数情况下来说都是足够精确的。</span><span>对于其他运算数来说，放大系数取多少没有强制规定，不过一般来说都是越大精度越高，但是一定要考虑到16位（32位）整型数据的上下限。</span><span>下面附上二分查找 <em>arctan</em> 的定点运算数值表：</span></p><div class=\"table\"><table><thead><tr><th style=\"text-align:center\">序号</th><th style=\"text-align:left\">度数</th><th style=\"text-align:left\">x256</th><th style=\"text-align:left\">取整</th></tr></thead><tbody><tr><td style=\"text-align:center\">1</td><td style=\"text-align:left\">45.0</td><td style=\"text-align:left\">11520</td><td style=\"text-align:left\">11520</td></tr><tr><td style=\"text-align:center\">2</td><td style=\"text-align:left\">26.565051177078</td><td style=\"text-align:left\">6800.65310133196</td><td style=\"text-align:left\">6801</td></tr><tr><td style=\"text-align:center\">3</td><td style=\"text-align:left\">14.0362434679265</td><td style=\"text-align:left\">3593.27832778918</td><td style=\"text-align:left\">3593</td></tr><tr><td style=\"text-align:center\">4</td><td style=\"text-align:left\">7.1250163489018</td><td style=\"text-align:left\">1824.00418531886</td><td style=\"text-align:left\">1824</td></tr><tr><td style=\"text-align:center\">5</td><td style=\"text-align:left\">3.57633437499735</td><td style=\"text-align:left\">915.541599999322</td><td style=\"text-align:left\">916</td></tr><tr><td style=\"text-align:center\">6</td><td style=\"text-align:left\">1.78991060824607</td><td style=\"text-align:left\">458.217115710994</td><td style=\"text-align:left\">458</td></tr><tr><td style=\"text-align:center\">7</td><td style=\"text-align:left\">0.8951737102111</td><td style=\"text-align:left\">229.164469814035</td><td style=\"text-align:left\">229</td></tr><tr><td style=\"text-align:center\">8</td><td style=\"text-align:left\">0.4476141708606</td><td style=\"text-align:left\">114.589227740302</td><td style=\"text-align:left\">115</td></tr><tr><td style=\"text-align:center\">9</td><td style=\"text-align:left\">0.2238105003685</td><td style=\"text-align:left\">57.2954880943458</td><td style=\"text-align:left\">57</td></tr><tr><td style=\"text-align:center\">10</td><td style=\"text-align:left\">0.1119056770662</td><td style=\"text-align:left\">28.647853328949</td><td style=\"text-align:left\">29</td></tr><tr><td style=\"text-align:center\">11</td><td style=\"text-align:left\">0.0559528918938</td><td style=\"text-align:left\">14.3239403248137</td><td style=\"text-align:left\">14</td></tr><tr><td style=\"text-align:center\">12</td><td style=\"text-align:left\">0.027976452617</td><td style=\"text-align:left\">7.16197186995294</td><td style=\"text-align:left\">7</td></tr><tr><td style=\"text-align:center\">13</td><td style=\"text-align:left\">0.01398822714227</td><td style=\"text-align:left\">3.58098614841984</td><td style=\"text-align:left\">4</td></tr><tr><td style=\"text-align:center\">14</td><td style=\"text-align:left\">0.006994113675353</td><td style=\"text-align:left\">1.79049310089035</td><td style=\"text-align:left\">2</td></tr><tr><td style=\"text-align:center\">15</td><td style=\"text-align:left\">0.003497056850704</td><td style=\"text-align:left\">0.8952465537802</td><td style=\"text-align:left\">1</td></tr></tbody></table></div><p><span>最终的程序代码如下：</span></p><pre class=\"c\"><code><ul class=\"gutter\"><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li><li>11</li><li>12</li><li>13</li><li>14</li><li>15</li><li>16</li><li>17</li><li>18</li><li>19</li><li>20</li><li>21</li><li>22</li><li>23</li><li>24</li><li>25</li><li>26</li><li>27</li><li>28</li><li>29</li><li>30</li><li>31</li><li>32</li><li>33</li></ul><ul class=\"code\"><li><span class=\"hljs-keyword\">int</span> angle[] = {<span class=\"hljs-number\">11520</span>, <span class=\"hljs-number\">6801</span>, <span class=\"hljs-number\">3593</span>, <span class=\"hljs-number\">1824</span>, <span class=\"hljs-number\">916</span>,</li><li>    <span class=\"hljs-number\">458</span>, <span class=\"hljs-number\">229</span>, <span class=\"hljs-number\">115</span>, <span class=\"hljs-number\">57</span>, <span class=\"hljs-number\">29</span>, <span class=\"hljs-number\">14</span>, <span class=\"hljs-number\">7</span>, <span class=\"hljs-number\">4</span>, <span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">1</span>};</li><li></li><li><span class=\"hljs-keyword\">int</span> i = <span class=\"hljs-number\">0</span>;</li><li><span class=\"hljs-keyword\">int</span> x, y;</li><li><span class=\"hljs-keyword\">int</span> y_new = <span class=\"hljs-number\">0</span>,x_new = <span class=\"hljs-number\">0</span>,anglesum = <span class=\"hljs-number\">0</span>;</li><li></li><li>x = <span class=\"hljs-number\">1024</span>;</li><li>y = (<span class=\"hljs-keyword\">int</span>)(<span class=\"hljs-number\">3.0</span>/<span class=\"hljs-number\">2.0</span>*<span class=\"hljs-number\">1024</span>);  </li><li><span class=\"hljs-comment\">//这个数字更大的话，精度会更高；其中3/2是y/x的值</span></li><li></li><li><span class=\"hljs-keyword\">for</span>(i = <span class=\"hljs-number\">0</span>; i &lt; <span class=\"hljs-number\">15</span>; i++)</li><li>{</li><li>    <span class=\"hljs-keyword\">if</span>(y &lt; <span class=\"hljs-number\">0</span>)</li><li>    {</li><li>        x_new = x - (y &gt;&gt; i);</li><li>        y_new = y + (x &gt;&gt; i);</li><li>        x = x_new;</li><li>        y = y_new;</li><li>        anglesum -=angle[i];</li><li>    }</li><li>    <span class=\"hljs-keyword\">else</span></li><li>    {</li><li>        x_new = x + (y &gt;&gt; i);</li><li>        y_new = y - (x &gt;&gt; i);</li><li>        x = x_new;</li><li>        y = y_new;</li><li>        anglesum +=angle[i];</li><li>    }</li><li>}</li><li><span class=\"hljs-built_in\">printf</span>(<span class=\"hljs-string\">\"The ans is %f\\n.\"</span>,anglesum);</li><li></li><li><span class=\"hljs-comment\">//The ans is 14420.</span></li></ul></code></pre><p><span>由于角度都被放大了256倍，所以它对应实际的角度应该是<span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mfrac><mrow><mn>1</mn><mn>4</mn><mn>4</mn><mn>2</mn><mn>0</mn></mrow><mrow><mn>2</mn><mn>5</mn><mn>6</mn></mrow></mfrac><mo>=</mo><mn>5</mn><mn>6</mn><mi mathvariant=\"normal\">.</mi><mn>3</mn><mn>2</mn><mn>8</mn><mn>1</mn><mn>2</mn><msup><mn>5</mn><mo>∘</mo></msup></mrow><annotation encoding=\"application/x-tex\">\\frac{14420}{256}=56.328125^\\circ</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"strut\" style=\"height:0.845108em;\"></span><span class=\"strut bottom\" style=\"height:1.190108em;vertical-align:-0.345em;\"></span><span class=\"base textstyle uncramped\"><span class=\"mord reset-textstyle textstyle uncramped\"><span class=\"mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist\"><span style=\"top:0.345em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">2</span><span class=\"mord mathrm mtight\">5</span><span class=\"mord mathrm mtight\">6</span></span></span></span><span style=\"top:-0.22999999999999998em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle textstyle uncramped frac-line\"></span></span><span style=\"top:-0.394em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle uncramped mtight\"><span class=\"mord scriptstyle uncramped mtight\"><span class=\"mord mathrm mtight\">1</span><span class=\"mord mathrm mtight\">4</span><span class=\"mord mathrm mtight\">4</span><span class=\"mord mathrm mtight\">2</span><span class=\"mord mathrm mtight\">0</span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span><span class=\"mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span></span><span class=\"mrel\">=</span><span class=\"mord mathrm\">5</span><span class=\"mord mathrm\">6</span><span class=\"mord mathrm\">.</span><span class=\"mord mathrm\">3</span><span class=\"mord mathrm\">2</span><span class=\"mord mathrm\">8</span><span class=\"mord mathrm\">1</span><span class=\"mord mathrm\">2</span><span class=\"mord\"><span class=\"mord mathrm\">5</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:-0.363em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle uncramped mtight\"><span class=\"mbin mtight\">∘</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span></span></span>。</span></p><h1 id=\"BCORDICE79A84E68EA8E5B9BF\">CORDIC的推广</h1><p><span>至此，CORDIC的基本原理就介绍完了，但是 <em>arctan</em> 只是CORDIC的一个特例，要将CORDIC扩展到全部的三角函数，甚至于双曲函数，线性函数，还需要统一CORDIC的迭代公式。</span></p><h2 id=\"BE79086E8AEBAE58886E69E90\">理论分析</h2><p><span>我们回到最初的圆周坐标旋转公式：</span><span><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mrow><mo fence=\"true\">{</mo><mtable><mtr><mtd><mrow><msub><mi>x</mi><mn>2</mn></msub><mo>=</mo><mi>c</mi><mi>o</mi><mi>s</mi><mi>θ</mi><mo>(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>y</mi><mn>1</mn></msub><mo>⋅</mo><mi>t</mi><mi>a</mi><mi>n</mi><mi>θ</mi><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>y</mi><mn>2</mn></msub><mo>=</mo><mi>c</mi><mi>o</mi><mi>s</mi><mi>θ</mi><mo>(</mo><msub><mi>y</mi><mn>1</mn></msub><mo>−</mo><msub><mi>x</mi><mn>1</mn></msub><mo>⋅</mo><mi>t</mi><mi>a</mi><mi>n</mi><mi>θ</mi><mo>)</mo></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding=\"application/x-tex\">\\left\\{\\begin{matrix}</span><span>x_2=cos\\theta(x_1+y_1\\cdot tan\\theta)\\\\</span><span>y_2=cos\\theta(y_1-x_1\\cdot tan\\theta)</span><span>\\end{matrix}\\right.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"strut\" style=\"height:1.45em;\"></span><span class=\"strut bottom\" style=\"height:2.40003em;vertical-align:-0.95003em;\"></span><span class=\"base displaystyle textstyle uncramped\"><span class=\"minner displaystyle textstyle uncramped\"><span class=\"mopen style-wrap reset-textstyle textstyle uncramped\" style=\"top:0em;\"><span class=\"delimsizing size3\">{</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist\"><span style=\"top:-0.6099999999999999em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">2</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord mathit\">c</span><span class=\"mord mathit\">o</span><span class=\"mord mathit\">s</span><span class=\"mord mathit\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">1</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">+</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">1</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mord mathit\">t</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">n</span><span class=\"mord mathit\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mclose\">)</span></span></span><span style=\"top:0.5900000000000003em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">2</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord mathit\">c</span><span class=\"mord mathit\">o</span><span class=\"mord mathit\">s</span><span class=\"mord mathit\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">1</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">−</span><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">1</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mord mathit\">t</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">n</span><span class=\"mord mathit\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mclose\">)</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span><span class=\"mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span></span></span></span></span></span></span><span>由上述的分析可知，CORDIC实际上就是由向量旋转去逼近真实值的一种算法，那么只要推导出了旋转n次之后的角度通项公式，那么实际就能解出圆周变换中的所有数值。</span><span>我们根据上面的公式，可以进一步推广为：</span><span><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mrow><mo fence=\"true\">{</mo><mtable><mtr><mtd><mrow><mrow><mo fence=\"true\">[</mo><mtable><mtr><mtd><mrow><msub><mi>x</mi><mi>n</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>y</mi><mi>n</mi></msub></mrow></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mo>=</mo><msubsup><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>n</mi></mrow></msubsup><mi>c</mi><mi>o</mi><mi>s</mi><mo>(</mo><msub><mi>θ</mi><mi>i</mi></msub><mo>)</mo><mrow><mo fence=\"true\">(</mo><mtable><mtr><mtd><mrow><mn>1</mn></mrow></mtd><mtd><mrow><mo>−</mo><msub><mi>d</mi><mi>i</mi></msub><mi>t</mi><mi>a</mi><mi>n</mi><mo>(</mo><msub><mi>θ</mi><mi>i</mi></msub><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><mo>−</mo><msub><mi>d</mi><mi>i</mi></msub><mi>t</mi><mi>a</mi><mi>n</mi><mo>(</mo><msub><mi>θ</mi><mi>i</mi></msub><mo>)</mo></mrow></mtd><mtd><mrow><mn>1</mn></mrow></mtd></mtr></mtable><mo fence=\"true\">)</mo></mrow><mrow><mo fence=\"true\">[</mo><mtable><mtr><mtd><mrow><msub><mi>x</mi><mn>0</mn></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>y</mi><mn>0</mn></msub></mrow></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>z</mi><mi>n</mi></msub><mo>=</mo><msub><mi>z</mi><mn>0</mn></msub><mo>+</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>n</mi></mrow></msubsup><msub><mi>d</mi><mi>i</mi></msub><msub><mi>θ</mi><mi>i</mi></msub></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding=\"application/x-tex\">\\left\\{\\begin{matrix}</span><span>\\begin{bmatrix}</span><span>x_n\\\\</span><span>y_n </span><span>\\end{bmatrix}</span><span>=\\prod_{i=1}^{n}cos(\\theta_i)</span><span>\\begin{pmatrix}</span><span>1 &amp; -d_itan(\\theta_i)\\\\</span><span>-d_itan(\\theta_i) &amp; 1</span><span>\\end{pmatrix}</span><span>\\begin{bmatrix}</span><span>x_0\\\\</span><span>y_0</span><span>\\end{bmatrix}\\\\</span><span>z_n=z_0+\\sum_{i=1}^{n}d_i\\theta_i</span><span>\\end{matrix}\\right.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"strut\" style=\"height:3.1790659999999997em;\"></span><span class=\"strut bottom\" style=\"height:5.8581319999999995em;vertical-align:-2.6790659999999997em;\"></span><span class=\"base displaystyle textstyle uncramped\"><span class=\"minner displaystyle textstyle uncramped\"><span class=\"mopen style-wrap reset-textstyle textstyle uncramped\"><span class=\"delimsizing mult\"><span class=\"vlist\"><span style=\"top:1.5500099999999999em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎩</span></span></span><span style=\"top:1.5500099999999999em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎪</span></span></span><span style=\"top:1.2500099999999998em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎪</span></span></span><span style=\"top:0.9500099999999998em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎪</span></span></span><span style=\"top:-0.000010000000000287557em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎨</span></span></span><span style=\"top:-1.1500100000000002em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎪</span></span></span><span style=\"top:-1.4500100000000002em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎪</span></span></span><span style=\"top:-1.7500100000000003em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎪</span></span></span><span style=\"top:-2.0500200000000004em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎧</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist\"><span style=\"top:-1.5276689999999995em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:1em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"minner displaystyle textstyle uncramped\"><span class=\"mopen style-wrap reset-textstyle textstyle uncramped\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist\"><span style=\"top:-0.6099999999999999em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">n</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span></span><span style=\"top:0.5900000000000003em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">n</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span><span class=\"mclose style-wrap reset-textstyle textstyle uncramped\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span><span class=\"mrel\">=</span><span class=\"mop op-limits\"><span class=\"vlist\"><span style=\"top:1.1776689999999999em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mathrm mtight\">1</span></span></span></span><span style=\"top:-0.000005000000000143778em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span><span class=\"mop op-symbol large-op\">∏</span></span></span><span style=\"top:-1.2500050000000003em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle uncramped mtight\"><span class=\"mord scriptstyle uncramped mtight\"><span class=\"mord mathit mtight\">n</span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span><span class=\"mord mathit\">c</span><span class=\"mord mathit\">o</span><span class=\"mord mathit\">s</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.02778em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mclose\">)</span><span class=\"minner displaystyle textstyle uncramped\"><span class=\"mopen style-wrap reset-textstyle textstyle uncramped\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist\"><span style=\"top:-0.6099999999999999em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord mathrm\">1</span></span></span><span style=\"top:0.5900000000000003em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mord mathit\">d</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mord mathit\">t</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">n</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.02778em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mclose\">)</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist\"><span style=\"top:-0.6099999999999999em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mord mathit\">d</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mord mathit\">t</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">n</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.02778em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:0.5900000000000003em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord mathrm\">1</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span><span class=\"mclose style-wrap reset-textstyle textstyle uncramped\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span><span class=\"minner displaystyle textstyle uncramped\"><span class=\"mopen style-wrap reset-textstyle textstyle uncramped\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist\"><span style=\"top:-0.6099999999999999em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span></span><span style=\"top:0.5900000000000003em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span><span class=\"mclose style-wrap reset-textstyle textstyle uncramped\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span></span></span><span style=\"top:1.4013969999999998em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:1em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.04398em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">n</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.04398em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">+</span><span class=\"mop op-limits\"><span class=\"vlist\"><span style=\"top:1.1776689999999999em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mathrm mtight\">1</span></span></span></span><span style=\"top:-0.000005000000000143778em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-1.2500050000000003em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle uncramped mtight\"><span class=\"mord scriptstyle uncramped mtight\"><span class=\"mord mathit mtight\">n</span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span><span class=\"mord\"><span class=\"mord mathit\">d</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.02778em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:1em;\">​</span></span>​</span></span></span></span></span><span class=\"mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span></span></span></span></span></span></span><span>其中 <em>d<sub>i</sub></em> 是指的旋转方向， <em>d<sub>i</sub> = -1</em> 示顺时针旋转， <em>d<sub>i</sub> = 1</em> 表示逆时针旋转。 <em>θ<sub>i</sub></em> 是指的当次旋转的角度， <em>z</em> 是指角度旋转的累加值。</span><span>根据上一节中关于取消乘法的算法，将其中的 <em>tan(θ<sub>i</sub>)</em> 做强制约束，令其等于 <em>2<sup>-i</sup></em> ，所以就有 <em>θ<sub>i</sub> = arctan(2<sup>-i</sup>)</em> 。</span><span>由于每次旋转的角度都为预定值，所以 <em>cos(θ<sub>i</sub>)</em> 也是常数，因此若是将此比例常数从迭代方程中去掉，迭代完成后的计算值和实际值的比例关系也必然是常数，并且此时方程中就仅有移位加运算。比例常数和方程的乘积可以在系统的任意部分处理（不一定在CORDIC中完成），或者可以直接作为系统处理的增益。设比例常数为 <em>k<sub>i</sub></em> ，那么根据方程可以推导出：</span><span><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><msub><mi>k</mi><mi>i</mi></msub><mo>=</mo><msub><mi>lim</mi><mrow><mi>n</mi><mo>→</mo><mi mathvariant=\"normal\">∞</mi></mrow></msub><msubsup><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msubsup><mi>c</mi><mi>o</mi><mi>s</mi><mo>(</mo><msub><mi>θ</mi><mi>i</mi></msub><mo>)</mo><mo>=</mo><msub><mi>lim</mi><mrow><mi>n</mi><mo>→</mo><mi mathvariant=\"normal\">∞</mi></mrow></msub><msubsup><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msubsup><msqrt><mrow><mn>1</mn><mo>+</mo><msup><mn>2</mn><mrow><mo>−</mo><mn>2</mn><mi>i</mi></mrow></msup></mrow></msqrt><mo>=</mo><mn>0</mn><mi mathvariant=\"normal\">.</mi><mn>6</mn><mn>0</mn><mn>7</mn><mn>2</mn><mn>5</mn><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">k_i=\\lim_{n\\rightarrow \\infty }\\prod_{i=0}^{n-1}cos(\\theta_i) =\\lim_{n \\to \\infty }\\prod_{i=0}^{n-1}\\sqrt{1+2^{-2i}}=0.607253</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"strut\" style=\"height:1.8011130000000004em;\"></span><span class=\"strut bottom\" style=\"height:3.0787820000000004em;vertical-align:-1.277669em;\"></span><span class=\"base displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03148em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mop op-limits\"><span class=\"vlist\"><span style=\"top:0.6em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">n</span><span class=\"mrel mtight\">→</span><span class=\"mord mathrm mtight\">∞</span></span></span></span><span style=\"top:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span><span class=\"mop\">lim</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span><span class=\"mop op-limits\"><span class=\"vlist\"><span style=\"top:1.1776689999999999em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mathrm mtight\">0</span></span></span></span><span style=\"top:-0.000005000000000143778em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span><span class=\"mop op-symbol large-op\">∏</span></span></span><span style=\"top:-1.2500050000000003em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle uncramped mtight\"><span class=\"mord scriptstyle uncramped mtight\"><span class=\"mord mathit mtight\">n</span><span class=\"mbin mtight\">−</span><span class=\"mord mathrm mtight\">1</span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span><span class=\"mord mathit\">c</span><span class=\"mord mathit\">o</span><span class=\"mord mathit\">s</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.02778em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mclose\">)</span><span class=\"mrel\">=</span><span class=\"mop op-limits\"><span class=\"vlist\"><span style=\"top:0.6em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">n</span><span class=\"mrel mtight\">→</span><span class=\"mord mathrm mtight\">∞</span></span></span></span><span style=\"top:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span><span class=\"mop\">lim</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span><span class=\"mop op-limits\"><span class=\"vlist\"><span style=\"top:1.1776689999999999em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mathrm mtight\">0</span></span></span></span><span style=\"top:-0.000005000000000143778em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span><span class=\"mop op-symbol large-op\">∏</span></span></span><span style=\"top:-1.2500050000000003em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle uncramped mtight\"><span class=\"mord scriptstyle uncramped mtight\"><span class=\"mord mathit mtight\">n</span><span class=\"mbin mtight\">−</span><span class=\"mord mathrm mtight\">1</span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span><span class=\"mord sqrt\"><span class=\"sqrt-sign\" style=\"top:-0.177547em;\"><span class=\"style-wrap reset-textstyle textstyle uncramped\"><span class=\"delimsizing size1\">√</span></span></span><span class=\"vlist\"><span style=\"top:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:1em;\">​</span></span><span class=\"mord displaystyle textstyle cramped\"><span class=\"mord mathrm\">1</span><span class=\"mbin\">+</span><span class=\"mord\"><span class=\"mord mathrm\">2</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:-0.289em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord scriptstyle cramped mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mathrm mtight\">2</span><span class=\"mord mathit mtight\">i</span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span></span><span style=\"top:-0.987547em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:1em;\">​</span></span><span class=\"reset-textstyle textstyle uncramped sqrt-line\"></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:1em;\">​</span></span>​</span></span></span><span class=\"mrel\">=</span><span class=\"mord mathrm\">0</span><span class=\"mord mathrm\">.</span><span class=\"mord mathrm\">6</span><span class=\"mord mathrm\">0</span><span class=\"mord mathrm\">7</span><span class=\"mord mathrm\">2</span><span class=\"mord mathrm\">5</span><span class=\"mord mathrm\">3</span></span></span></span></span></span><span>去除 <em>k<sub>i</sub></em> 之后，由系统的通项公式我们可以写出CORDIC圆周变换下的差分方程：</span><span><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mrow><mo fence=\"true\">{</mo><mtable><mtr><mtd><mrow><msub><mi>x</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><msub><mi>d</mi><mi>i</mi></msub><mo>⋅</mo><msup><mn>2</mn><mrow><mo>−</mo><mi>i</mi></mrow></msup><mo>⋅</mo><msub><mi>y</mi><mi>i</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>y</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>y</mi><mi>i</mi></msub><mo>+</mo><msub><mi>d</mi><mi>i</mi></msub><mo>⋅</mo><msup><mn>2</mn><mrow><mo>−</mo><mi>i</mi></mrow></msup><mo>⋅</mo><msub><mi>x</mi><mi>i</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>z</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><msub><mi>d</mi><mi>i</mi></msub><mo>⋅</mo><msub><mi>θ</mi><mi>i</mi></msub></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding=\"application/x-tex\">\\left\\{\\begin{matrix}</span><span>x_{i+1}=x_i-d_i\\cdot 2^{-i}\\cdot y_i\\\\ </span><span>y_{i+1}=y_i+d_i\\cdot 2^{-i}\\cdot x_i\\\\ </span><span>z_{i+1}=z_i-d_i\\cdot \\theta_i</span><span>\\end{matrix}\\right.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"strut\" style=\"height:2.084664em;\"></span><span class=\"strut bottom\" style=\"height:3.6693279999999997em;vertical-align:-1.5846639999999996em;\"></span><span class=\"base displaystyle textstyle uncramped\"><span class=\"minner displaystyle textstyle uncramped\"><span class=\"mopen style-wrap reset-textstyle textstyle uncramped\"><span class=\"delimsizing mult\"><span class=\"vlist\"><span style=\"top:0.65001em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎩</span></span></span><span style=\"top:-0.000010000000000065512em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎨</span></span></span><span style=\"top:-1.15002em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎧</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist\"><span style=\"top:-1.21em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mathrm mtight\">1</span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">−</span><span class=\"mord\"><span class=\"mord mathit\">d</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mord\"><span class=\"mord mathrm\">2</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:-0.41300000000000003em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle uncramped mtight\"><span class=\"mord scriptstyle uncramped mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mathit mtight\">i</span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span></span><span style=\"top:0.024663999999999853em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mathrm mtight\">1</span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">+</span><span class=\"mord\"><span class=\"mord mathit\">d</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mord\"><span class=\"mord mathrm\">2</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:-0.41300000000000003em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle uncramped mtight\"><span class=\"mord scriptstyle uncramped mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mathit mtight\">i</span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span></span><span style=\"top:1.2246639999999995em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.04398em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mathrm mtight\">1</span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.04398em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">−</span><span class=\"mord\"><span class=\"mord mathit\">d</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.02778em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span><span class=\"mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span></span></span></span></span></span></span><span>其中 <em>d<sub>i</sub></em> 和前面一样，表示旋转方向。</span></p><h2 id=\"BE4B8A4E7A78DE6978BE8BDACE6A8A1E5BC8F\">两种旋转模式</h2><p><span>从差分方程中，我们可以看出，CORDIC算法中可以设定的边界条件有三种：</span></p><ol><li><p><span>x<sub>n</sub> → 0</span></p></li><li><p><span>y<sub>n</sub> → 0</span></p></li><li><p><span>z<sub>n</sub> → 0</span></p></li></ol><p><span>但实际上x<sub>n</sub>→0和y<sub>n</sub>→0是一样的，只是旋转方向不同而已，所以一共有两种旋转模式。其中，y<sub>n</sub>→0被称作 <em>向量模式</em> ；z<sub>n</sub>→0被称做 <em>旋转模式</em> 。</span></p><h3 id=\"BE59091E9878FE6A8A1E5BC8F\">向量模式</h3><p><span>此模式下， <em>d<sub>i</sub></em> 的符号由 <em>y(i)</em> 来决定，于是有 <em>d<sub>i</sub> = -sign(y(i))</em> 。</span><span>那么经过n次迭代之后，得到：</span><span><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mrow><mo fence=\"true\">{</mo><mtable><mtr><mtd><mrow><msub><mi>x</mi><mi>n</mi></msub><mo>=</mo><msub><mi>k</mi><mi>i</mi></msub><mo>⋅</mo><mo>(</mo><msqrt><mrow><msubsup><mi>x</mi><mn>0</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>y</mi><mn>0</mn><mn>2</mn></msubsup></mrow></msqrt><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>y</mi><mi>n</mi></msub><mo>=</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>z</mi><mi>n</mi></msub><mo>=</mo><msub><mi>z</mi><mn>0</mn></msub><mo>+</mo><mi>a</mi><mi>r</mi><mi>c</mi><mi>t</mi><mi>a</mi><mi>n</mi><mo>(</mo><mfrac><mrow><msub><mi>y</mi><mn>0</mn></msub></mrow><mrow><msub><mi>x</mi><mn>0</mn></msub></mrow></mfrac><mo>)</mo></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding=\"application/x-tex\">\\left\\{\\begin{matrix}</span><span>x_n=k_i\\cdot (\\sqrt{x_0^2+y_0^2})\\\\ </span><span>y_n=0\\\\ </span><span>z_n=z_0+arctan(\\frac{y_0}{x_0})</span><span>\\end{matrix}\\right.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"strut\" style=\"height:2.74179em;\"></span><span class=\"strut bottom\" style=\"height:4.98358em;vertical-align:-2.24179em;\"></span><span class=\"base displaystyle textstyle uncramped\"><span class=\"minner displaystyle textstyle uncramped\"><span class=\"mopen style-wrap reset-textstyle textstyle uncramped\"><span class=\"delimsizing mult\"><span class=\"vlist\"><span style=\"top:1.25001em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎩</span></span></span><span style=\"top:1.25001em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎪</span></span></span><span style=\"top:0.95001em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎪</span></span></span><span style=\"top:-0.000010000000000065512em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎨</span></span></span><span style=\"top:-1.15001em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎪</span></span></span><span style=\"top:-1.45001em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎪</span></span></span><span style=\"top:-1.7500200000000001em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎧</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist\"><span style=\"top:-1.4431049999999999em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:1em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">n</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03148em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mopen\">(</span><span class=\"mord sqrt\"><span class=\"sqrt-sign\" style=\"top:-0.10868500000000014em;\"><span class=\"style-wrap reset-textstyle textstyle uncramped\"><span class=\"delimsizing size2\">√</span></span></span><span class=\"vlist\"><span style=\"top:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:1em;\">​</span></span><span class=\"mord displaystyle textstyle cramped\"><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.26630799999999993em;margin-left:0em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span style=\"top:-0.34480000000000005em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">2</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">+</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.26630799999999993em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span style=\"top:-0.34480000000000005em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">2</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span></span><span style=\"top:-1.218685em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:1em;\">​</span></span><span class=\"reset-textstyle textstyle uncramped sqrt-line\"></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:1em;\">​</span></span>​</span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-0.061769999999999825em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:1em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">n</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord mathrm\">0</span></span></span><span style=\"top:1.4057899999999999em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:1em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.04398em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">n</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.04398em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">+</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathit\">c</span><span class=\"mord mathit\">t</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">n</span><span class=\"mopen\">(</span><span class=\"mord reset-textstyle displaystyle textstyle uncramped\"><span class=\"mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist\"><span style=\"top:0.686em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle textstyle cramped\"><span class=\"mord textstyle cramped\"><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span></span></span><span style=\"top:-0.22999999999999998em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle textstyle uncramped frac-line\"></span></span><span style=\"top:-0.677em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle textstyle uncramped\"><span class=\"mord textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span><span class=\"mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span></span><span class=\"mclose\">)</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:1em;\">​</span></span>​</span></span></span></span></span><span class=\"mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span></span></span></span></span></span></span><span>在向量化模式中，CORDIC将输入的任意向量通过一系列的旋转，最终使向量与 <em>x</em> 轴对齐。向量化的结果为所有旋转角度的累加值，以及输入向量定标后的幅度值（输入向量的模），分量 <em>y</em> 的符号决定下一次的旋转方向，角度累加器初始化值为0，迭代结束后其值为最终旋转的角度值。</span></p><h3 id=\"BE6978BE8BDACE6A8A1E5BC8F\">旋转模式</h3><p><span>此模式下， <em>d<sub>i</sub></em> 的符号由 <em>z(i)</em> 来决定，于是有 <em>d<sub>i</sub> = -sign(z(i))</em> 。</span><span>那么经过n次迭代之后，得到：</span><span><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mrow><mo fence=\"true\">{</mo><mtable><mtr><mtd><mrow><msub><mi>x</mi><mi>n</mi></msub><mo>=</mo><msub><mi>k</mi><mi>i</mi></msub><mo>⋅</mo><mo>(</mo><msub><mi>x</mi><mn>0</mn></msub><mi>c</mi><mi>o</mi><mi>s</mi><mo>(</mo><msub><mi>z</mi><mn>0</mn></msub><mo>)</mo><mo>−</mo><msub><mi>y</mi><mn>0</mn></msub><mi>s</mi><mi>i</mi><mi>n</mi><mo>(</mo><msub><mi>z</mi><mn>0</mn></msub><mo>)</mo><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>y</mi><mi>n</mi></msub><mo>=</mo><msub><mi>k</mi><mi>i</mi></msub><mo>⋅</mo><mo>(</mo><msub><mi>y</mi><mn>0</mn></msub><mi>c</mi><mi>o</mi><mi>s</mi><mo>(</mo><msub><mi>z</mi><mn>0</mn></msub><mo>)</mo><mo>+</mo><msub><mi>x</mi><mn>0</mn></msub><mi>s</mi><mi>i</mi><mi>n</mi><mo>(</mo><msub><mi>z</mi><mn>0</mn></msub><mo>)</mo><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>z</mi><mi>n</mi></msub><mo>=</mo><mn>0</mn></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding=\"application/x-tex\">\\left\\{\\begin{matrix}</span><span>x_n=k_i\\cdot (x_0cos(z_0)-y_0sin(z_0))\\\\</span><span>y_n=k_i\\cdot (y_0cos(z_0)+x_0sin(z_0))\\\\</span><span>z_n=0</span><span>\\end{matrix}\\right.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"strut\" style=\"height:2.05002em;\"></span><span class=\"strut bottom\" style=\"height:3.60004em;vertical-align:-1.55002em;\"></span><span class=\"base displaystyle textstyle uncramped\"><span class=\"minner displaystyle textstyle uncramped\"><span class=\"mopen style-wrap reset-textstyle textstyle uncramped\"><span class=\"delimsizing mult\"><span class=\"vlist\"><span style=\"top:0.65001em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎩</span></span></span><span style=\"top:-0.000010000000000065512em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎨</span></span></span><span style=\"top:-1.15002em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎧</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist\"><span style=\"top:-1.2099999999999997em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">n</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03148em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mord mathit\">c</span><span class=\"mord mathit\">o</span><span class=\"mord mathit\">s</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.04398em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mclose\">)</span><span class=\"mbin\">−</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mord mathit\">s</span><span class=\"mord mathit\">i</span><span class=\"mord mathit\">n</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.04398em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\">)</span></span></span><span style=\"top:-0.00999999999999951em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">n</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03148em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mord mathit\">c</span><span class=\"mord mathit\">o</span><span class=\"mord mathit\">s</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.04398em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mclose\">)</span><span class=\"mbin\">+</span><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mord mathit\">s</span><span class=\"mord mathit\">i</span><span class=\"mord mathit\">n</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.04398em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\">)</span></span></span><span style=\"top:1.1900000000000006em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.04398em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">n</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord mathrm\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span><span class=\"mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span></span></span></span></span></span></span><span>在旋转模式下，角度累加器初始值为需要旋转的角度值。在整个迭代过程中，旋转的方向用语减小角度累加器中剩余的角度值。所以，旋转方向由迭代后剩余角度的符号确定。</span></p><h2 id=\"BE6ADA3E5BCA6E4B88EE4BD99E5BCA6\">正弦与余弦</h2><p><span>已知角度求正弦余弦的值，很明显可以使用旋转模式下的CORDIC。如果令旋转的起始向量为： <em>(1,0)</em> （即x轴单位向量），输入为角度累加器初始值。带入旋转模式下的迭代公式：</span><span><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mrow><mo fence=\"true\">{</mo><mtable><mtr><mtd><mrow><msub><mi>x</mi><mi>n</mi></msub><mo>=</mo><msub><mi>k</mi><mi>i</mi></msub><mo>⋅</mo><msub><mi>x</mi><mn>0</mn></msub><mi>c</mi><mi>o</mi><mi>s</mi><mo>(</mo><msub><mi>z</mi><mn>0</mn></msub><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>y</mi><mi>n</mi></msub><mo>=</mo><msub><mi>k</mi><mi>i</mi></msub><mo>⋅</mo><msub><mi>x</mi><mn>0</mn></msub><mi>s</mi><mi>i</mi><mi>n</mi><mo>(</mo><msub><mi>z</mi><mn>0</mn></msub><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>z</mi><mi>n</mi></msub><mo>=</mo><mn>0</mn></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding=\"application/x-tex\">\\left\\{\\begin{matrix}</span><span>x_n=k_i\\cdot x_0cos(z_0)\\\\</span><span>y_n=k_i\\cdot x_0sin(z_0)\\\\</span><span>z_n=0</span><span>\\end{matrix}\\right.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"strut\" style=\"height:2.05002em;\"></span><span class=\"strut bottom\" style=\"height:3.60004em;vertical-align:-1.55002em;\"></span><span class=\"base displaystyle textstyle uncramped\"><span class=\"minner displaystyle textstyle uncramped\"><span class=\"mopen style-wrap reset-textstyle textstyle uncramped\"><span class=\"delimsizing mult\"><span class=\"vlist\"><span style=\"top:0.65001em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎩</span></span></span><span style=\"top:-0.000010000000000065512em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎨</span></span></span><span style=\"top:-1.15002em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎧</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist\"><span style=\"top:-1.2099999999999997em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">n</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03148em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mord mathit\">c</span><span class=\"mord mathit\">o</span><span class=\"mord mathit\">s</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.04398em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-0.00999999999999951em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">n</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03148em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mord mathit\">s</span><span class=\"mord mathit\">i</span><span class=\"mord mathit\">n</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.04398em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:1.1900000000000006em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.04398em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">n</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord mathrm\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span><span class=\"mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span></span></span></span></span></span></span><span>解得：</span><span><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mrow><mo fence=\"true\">{</mo><mtable><mtr><mtd><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mo>(</mo><msub><mi>z</mi><mn>0</mn></msub><mo>)</mo><mo>=</mo><mfrac><mrow><msub><mi>x</mi><mi>n</mi></msub></mrow><mrow><msub><mi>k</mi><mi>i</mi></msub></mrow></mfrac></mrow></mtd></mtr><mtr><mtd><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mo>(</mo><msub><mi>z</mi><mn>0</mn></msub><mo>)</mo><mo>=</mo><mfrac><mrow><msub><mi>y</mi><mi>n</mi></msub></mrow><mrow><msub><mi>k</mi><mi>i</mi></msub></mrow></mfrac></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding=\"application/x-tex\">\\left\\{\\begin{matrix}</span><span>cos(z_0)=\\frac{x_n}{k_i}\\\\ </span><span>sin(z_0)=\\frac{y_n}{k_i}</span><span>\\end{matrix}\\right.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"strut\" style=\"height:2.19356em;\"></span><span class=\"strut bottom\" style=\"height:3.8871200000000004em;vertical-align:-1.6935600000000002em;\"></span><span class=\"base displaystyle textstyle uncramped\"><span class=\"minner displaystyle textstyle uncramped\"><span class=\"mopen style-wrap reset-textstyle textstyle uncramped\"><span class=\"delimsizing mult\"><span class=\"vlist\"><span style=\"top:0.65001em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎩</span></span></span><span style=\"top:-0.000010000000000065512em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎨</span></span></span><span style=\"top:-1.15002em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎧</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist\"><span style=\"top:-1.086em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord mathit\">c</span><span class=\"mord mathit\">o</span><span class=\"mord mathit\">s</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.04398em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mclose\">)</span><span class=\"mrel\">=</span><span class=\"mord reset-textstyle displaystyle textstyle uncramped\"><span class=\"mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist\"><span style=\"top:0.686em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle textstyle cramped\"><span class=\"mord textstyle cramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03148em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span></span></span><span style=\"top:-0.22999999999999998em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle textstyle uncramped frac-line\"></span></span><span style=\"top:-0.677em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle textstyle uncramped\"><span class=\"mord textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">n</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span><span class=\"mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span></span></span></span><span style=\"top:0.8575600000000001em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord mathit\">s</span><span class=\"mord mathit\">i</span><span class=\"mord mathit\">n</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.04398em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mclose\">)</span><span class=\"mrel\">=</span><span class=\"mord reset-textstyle displaystyle textstyle uncramped\"><span class=\"mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist\"><span style=\"top:0.686em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle textstyle cramped\"><span class=\"mord textstyle cramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03148em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span></span></span><span style=\"top:-0.22999999999999998em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle textstyle uncramped frac-line\"></span></span><span style=\"top:-0.677em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle textstyle uncramped\"><span class=\"mord textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">n</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span><span class=\"mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span><span class=\"mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span></span></span></span></span></span></span></p><h2 id=\"BE58F8DE6ADA3E58887E4B88EE59091E9878FE79A84E6A8A1\">反正切与向量的模</h2><p><span>在上文中已经给出了反正切函数的具体求法，但未给出公式，这里给出反正切函数的迭代公式，具体原理就略过。</span><span>角度累加器初始值为0，使用向量模式，输入即为<span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mo>(</mo><msub><mi>x</mi><mn>0</mn></msub><mo separator=\"true\">,</mo><msub><mi>y</mi><mn>0</mn></msub><mo>)</mo></mrow><annotation encoding=\"application/x-tex\">(x_0,y_0)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"strut\" style=\"height:0.75em;\"></span><span class=\"strut bottom\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"base textstyle uncramped\"><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mpunct\">,</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mclose\">)</span></span></span></span>，带入向量模式下的迭代公式：</span><span><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mrow><mo fence=\"true\">{</mo><mtable><mtr><mtd><mrow><msub><mi>x</mi><mi>n</mi></msub><mo>=</mo><msub><mi>k</mi><mi>i</mi></msub><mo>⋅</mo><mo>(</mo><msqrt><mrow><msubsup><mi>x</mi><mn>0</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>y</mi><mn>0</mn><mn>2</mn></msubsup></mrow></msqrt><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>z</mi><mi>n</mi></msub><mo>=</mo><mi>a</mi><mi>r</mi><mi>c</mi><mi>t</mi><mi>a</mi><mi>n</mi><mo>(</mo><mfrac><mrow><msub><mi>y</mi><mn>0</mn></msub></mrow><mrow><msub><mi>x</mi><mn>0</mn></msub></mrow></mfrac><mo>)</mo></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding=\"application/x-tex\">\\left\\{\\begin{matrix}</span><span>x_n=k_i\\cdot (\\sqrt{x_0^2+y_0^2})\\\\ </span><span>z_n=arctan(\\frac{y_0}{x_0})</span><span>\\end{matrix}\\right.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"strut\" style=\"height:2.1417900000000003em;\"></span><span class=\"strut bottom\" style=\"height:3.7835800000000006em;vertical-align:-1.6417900000000003em;\"></span><span class=\"base displaystyle textstyle uncramped\"><span class=\"minner displaystyle textstyle uncramped\"><span class=\"mopen style-wrap reset-textstyle textstyle uncramped\"><span class=\"delimsizing mult\"><span class=\"vlist\"><span style=\"top:0.65001em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎩</span></span></span><span style=\"top:-0.000010000000000065512em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎨</span></span></span><span style=\"top:-1.15002em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎧</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist\"><span style=\"top:-0.8431050000000002em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:1em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">n</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03148em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mopen\">(</span><span class=\"mord sqrt\"><span class=\"sqrt-sign\" style=\"top:-0.10868500000000014em;\"><span class=\"style-wrap reset-textstyle textstyle uncramped\"><span class=\"delimsizing size2\">√</span></span></span><span class=\"vlist\"><span style=\"top:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:1em;\">​</span></span><span class=\"mord displaystyle textstyle cramped\"><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.26630799999999993em;margin-left:0em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span style=\"top:-0.34480000000000005em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">2</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">+</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.26630799999999993em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span style=\"top:-0.34480000000000005em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">2</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span></span><span style=\"top:-1.218685em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:1em;\">​</span></span><span class=\"reset-textstyle textstyle uncramped sqrt-line\"></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:1em;\">​</span></span>​</span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:0.8057900000000002em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:1em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.04398em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">n</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathit\">c</span><span class=\"mord mathit\">t</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">n</span><span class=\"mopen\">(</span><span class=\"mord reset-textstyle displaystyle textstyle uncramped\"><span class=\"mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist\"><span style=\"top:0.686em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle textstyle cramped\"><span class=\"mord textstyle cramped\"><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span></span></span><span style=\"top:-0.22999999999999998em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle textstyle uncramped frac-line\"></span></span><span style=\"top:-0.677em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle textstyle uncramped\"><span class=\"mord textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span><span class=\"mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span></span><span class=\"mclose\">)</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:1em;\">​</span></span>​</span></span></span></span></span><span class=\"mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span></span></span></span></span></span></span><span>根据公式可以看出，迭代之后角度累加器的值即是 <em>arctan</em> 。</span><span>由于向量模式下，迭代之后向量与X轴重合，所以这个模式下是可以一并求出原始向量的模的。只是要注意用<span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><msub><mi>k</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">k_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"strut\" style=\"height:0.69444em;\"></span><span class=\"strut bottom\" style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span class=\"base textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03148em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span></span></span>标定。</span></p><h2 id=\"BE58F8DE6ADA3E5BCA6E4B88EE58F8DE4BD99E5BCA6\">反正弦与反余弦</h2><p><span>与 <em>arctan</em> 类似的是，角度累加器初始值为0，但是输入的并不是向量的准确坐标，而是向量的x（或者是y）。</span><span>对于反正弦：设输入为 <em>c</em> ，另旋转的起始向量为： <em>(1,0)</em> ，边界条件为：y<sub>n</sub>→c，经过n次迭代之后：</span><span><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mrow><mo fence=\"true\">{</mo><mtable><mtr><mtd><mrow><msub><mi>x</mi><mi>n</mi></msub><mo>=</mo><msqrt><mrow><mo>(</mo><msub><mi>x</mi><mn>0</mn></msub><mo>⋅</mo><msub><mi>k</mi><mi>i</mi></msub><msup><mo>)</mo><mn>2</mn></msup><mo>−</mo><msup><mi>c</mi><mn>2</mn></msup></mrow></msqrt></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>y</mi><mi>n</mi></msub><mo>=</mo><mi>c</mi></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>z</mi><mi>n</mi></msub><mo>=</mo><mi>a</mi><mi>r</mi><mi>c</mi><mi>s</mi><mi>i</mi><mi>n</mi><mo>(</mo><mfrac><mrow><mi>c</mi></mrow><mrow><msub><mi>x</mi><mn>0</mn></msub><mo>⋅</mo><msub><mi>k</mi><mi>i</mi></msub></mrow></mfrac><mo>)</mo></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding=\"application/x-tex\">\\left\\{\\begin{matrix}</span><span>x_n=\\sqrt{(x_0\\cdot k_i)^2-c^2}\\\\ </span><span>y_n=c\\\\ </span><span>z_n=arcsin(\\frac{c}{x_0\\cdot k_i})</span><span>\\end{matrix}\\right.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"strut\" style=\"height:2.49372em;\"></span><span class=\"strut bottom\" style=\"height:4.48744em;vertical-align:-1.9937200000000002em;\"></span><span class=\"base displaystyle textstyle uncramped\"><span class=\"minner displaystyle textstyle uncramped\"><span class=\"mopen style-wrap reset-textstyle textstyle uncramped\"><span class=\"delimsizing mult\"><span class=\"vlist\"><span style=\"top:0.9500099999999998em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎩</span></span></span><span style=\"top:0.9500099999999998em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎪</span></span></span><span style=\"top:-0.000010000000000287557em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎨</span></span></span><span style=\"top:-1.1500100000000002em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎪</span></span></span><span style=\"top:-1.4500200000000003em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎧</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist\"><span style=\"top:-1.50984em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:1em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">n</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord sqrt\"><span class=\"sqrt-sign\" style=\"top:-0.09388000000000007em;\"><span class=\"style-wrap reset-textstyle textstyle uncramped\"><span class=\"delimsizing size1\">√</span></span></span><span class=\"vlist\"><span style=\"top:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:1em;\">​</span></span><span class=\"mord displaystyle textstyle cramped\"><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03148em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:-0.289em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">2</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">−</span><span class=\"mord\"><span class=\"mord mathit\">c</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:-0.289em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">2</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span></span><span style=\"top:-0.90388em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:1em;\">​</span></span><span class=\"reset-textstyle textstyle uncramped sqrt-line\"></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:1em;\">​</span></span>​</span></span></span></span></span><span style=\"top:-0.3098399999999996em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:1em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">n</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord mathit\">c</span></span></span><span style=\"top:1.15772em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:1em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.04398em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">n</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathit\">c</span><span class=\"mord mathit\">s</span><span class=\"mord mathit\">i</span><span class=\"mord mathit\">n</span><span class=\"mopen\">(</span><span class=\"mord reset-textstyle displaystyle textstyle uncramped\"><span class=\"mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist\"><span style=\"top:0.686em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle textstyle cramped\"><span class=\"mord textstyle cramped\"><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03148em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span></span></span><span style=\"top:-0.22999999999999998em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle textstyle uncramped frac-line\"></span></span><span style=\"top:-0.677em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle textstyle uncramped\"><span class=\"mord textstyle uncramped\"><span class=\"mord mathit\">c</span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span><span class=\"mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span></span><span class=\"mclose\">)</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:1em;\">​</span></span>​</span></span></span></span></span><span class=\"mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span></span></span></span></span></span></span><span>反余弦与之类似，同时反余弦的计算也可以用反正弦函数实现，只需从结果减去 <em>π/2</em> 即可。</span></p><h2 id=\"BE7BABFE680A7E58F98E68DA2EFBC9AE4B998E4B88EE999A4\">线性变换：乘与除</h2><p><span><img class=\"img-block\" src=\"/img/algorithm-CRODIC/03.png\" alt=\"线性变换\" title=\"线性变换\"><span class=\"img-title\">图03　线性变换</span></span><span>线性坐标系下的差分方程可以写为：</span><span><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mrow><mo fence=\"true\">{</mo><mtable><mtr><mtd><mrow><msub><mi>x</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mn>0</mn><mo>⋅</mo><msub><mi>d</mi><mi>i</mi></msub><mo>⋅</mo><msup><mn>2</mn><mrow><mo>−</mo><mi>i</mi></mrow></msup><mo>⋅</mo><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msub><mi>x</mi><mi>i</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>y</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>y</mi><mi>i</mi></msub><mo>+</mo><msub><mi>d</mi><mi>i</mi></msub><mo>⋅</mo><msup><mn>2</mn><mrow><mo>−</mo><mi>i</mi></mrow></msup><mo>⋅</mo><msub><mi>x</mi><mi>i</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>z</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><msub><mi>d</mi><mi>i</mi></msub><mo>⋅</mo><msup><mn>2</mn><mrow><mo>−</mo><mi>i</mi></mrow></msup></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding=\"application/x-tex\">\\left\\{\\begin{matrix}</span><span>x_{i+1}=x_i-0\\cdot d_i\\cdot 2^{-i}\\cdot y_i=x_i\\\\</span><span>y_{i+1}=y_i+d_i\\cdot 2^{-i}\\cdot x_i\\\\</span><span>z_{i+1}=z_i-d_i\\cdot 2^{-i}</span><span>\\end{matrix}\\right.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"strut\" style=\"height:2.1019959999999998em;\"></span><span class=\"strut bottom\" style=\"height:3.703992em;vertical-align:-1.6019960000000002em;\"></span><span class=\"base displaystyle textstyle uncramped\"><span class=\"minner displaystyle textstyle uncramped\"><span class=\"mopen style-wrap reset-textstyle textstyle uncramped\"><span class=\"delimsizing mult\"><span class=\"vlist\"><span style=\"top:0.65001em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎩</span></span></span><span style=\"top:-0.000010000000000065512em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎨</span></span></span><span style=\"top:-1.15002em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎧</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist\"><span style=\"top:-1.2273319999999996em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mathrm mtight\">1</span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">−</span><span class=\"mord mathrm\">0</span><span class=\"mbin\">⋅</span><span class=\"mord\"><span class=\"mord mathit\">d</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mord\"><span class=\"mord mathrm\">2</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:-0.41300000000000003em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle uncramped mtight\"><span class=\"mord scriptstyle uncramped mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mathit mtight\">i</span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span></span><span style=\"top:0.007332000000000172em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mathrm mtight\">1</span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">+</span><span class=\"mord\"><span class=\"mord mathit\">d</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mord\"><span class=\"mord mathrm\">2</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:-0.41300000000000003em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle uncramped mtight\"><span class=\"mord scriptstyle uncramped mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mathit mtight\">i</span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span></span><span style=\"top:1.241996em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.04398em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mathrm mtight\">1</span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.04398em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">−</span><span class=\"mord\"><span class=\"mord mathit\">d</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mord\"><span class=\"mord mathrm\">2</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:-0.41300000000000003em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle uncramped mtight\"><span class=\"mord scriptstyle uncramped mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mathit mtight\">i</span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span><span class=\"mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span></span></span></span></span></span></span></p><p><span>使用 <em>旋转模式</em> 迭代，最终会变成 <em>移位加法器</em> ：</span><span><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mrow><mo fence=\"true\">{</mo><mtable><mtr><mtd><mrow><msub><mi>x</mi><mi>n</mi></msub><mo>=</mo><msub><mi>x</mi><mn>0</mn></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>y</mi><mi>n</mi></msub><mo>=</mo><msub><mi>y</mi><mn>0</mn></msub><mo>+</mo><msub><mi>x</mi><mn>0</mn></msub><mo>⋅</mo><msub><mi>z</mi><mn>0</mn></msub></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding=\"application/x-tex\">\\left\\{\\begin{matrix}</span><span>x_n=x_0\\\\ </span><span>y_n=y_0+x_0\\cdot z_0</span><span>\\end{matrix}\\right.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"strut\" style=\"height:1.45em;\"></span><span class=\"strut bottom\" style=\"height:2.40003em;vertical-align:-0.95003em;\"></span><span class=\"base displaystyle textstyle uncramped\"><span class=\"minner displaystyle textstyle uncramped\"><span class=\"mopen style-wrap reset-textstyle textstyle uncramped\" style=\"top:0em;\"><span class=\"delimsizing size3\">{</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist\"><span style=\"top:-0.6099999999999999em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">n</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span></span><span style=\"top:0.5900000000000003em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">n</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">+</span><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.04398em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span><span class=\"mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span></span></span></span></span></span></span></p><p><span>使用 <em>向量模式</em> 会变成 <em>比例运算器（除法器）</em> ：</span><span><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mrow><mo fence=\"true\">{</mo><mtable><mtr><mtd><mrow><msub><mi>x</mi><mi>n</mi></msub><mo>=</mo><msub><mi>x</mi><mn>0</mn></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>y</mi><mi>n</mi></msub><mo>=</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>z</mi><mi>n</mi></msub><mo>=</mo><msub><mi>z</mi><mn>0</mn></msub><mo>−</mo><mfrac><mrow><msub><mi>y</mi><mn>0</mn></msub></mrow><mrow><msub><mi>x</mi><mn>0</mn></msub></mrow></mfrac></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding=\"application/x-tex\">\\left\\{\\begin{matrix}</span><span>x_n=x_0\\\\ </span><span>y_n=0\\\\</span><span>z_n=z_0-\\frac{y_0}{x_0}</span><span>\\end{matrix}\\right.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"strut\" style=\"height:2.42178em;\"></span><span class=\"strut bottom\" style=\"height:4.34356em;vertical-align:-1.92178em;\"></span><span class=\"base displaystyle textstyle uncramped\"><span class=\"minner displaystyle textstyle uncramped\"><span class=\"mopen style-wrap reset-textstyle textstyle uncramped\"><span class=\"delimsizing mult\"><span class=\"vlist\"><span style=\"top:0.9500099999999998em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎩</span></span></span><span style=\"top:0.9500099999999998em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎪</span></span></span><span style=\"top:-0.000010000000000287557em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎨</span></span></span><span style=\"top:-1.1500100000000002em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎪</span></span></span><span style=\"top:-1.4500200000000003em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎧</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist\"><span style=\"top:-1.58178em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">n</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span></span><span style=\"top:-0.38177999999999973em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">n</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord mathrm\">0</span></span></span><span style=\"top:1.08578em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.04398em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">n</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.04398em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">−</span><span class=\"mord reset-textstyle displaystyle textstyle uncramped\"><span class=\"mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist\"><span style=\"top:0.686em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle textstyle cramped\"><span class=\"mord textstyle cramped\"><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span></span></span><span style=\"top:-0.22999999999999998em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle textstyle uncramped frac-line\"></span></span><span style=\"top:-0.677em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle textstyle uncramped\"><span class=\"mord textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span><span class=\"mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span><span class=\"mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span></span></span></span></span></span></span></p><h2 id=\"BE58F8CE69BB2E58F98E68DA2EFBC9AE5BC80E5B9B3E696B9E6A0B9\">双曲变换：开平方根</h2><p><span>双曲函数和圆周函数有着相似的对应性，所以圆周变换的一些性质也可以应用到双曲变换中来，其中大部分推导过程是相似的，所以这里就不列出推导过程了，顺带介绍一下开根号运算。</span><span><img class=\"img-block\" src=\"/img/algorithm-CRODIC/04.png\" alt=\"双曲变换\" title=\"双曲变换\"><span class=\"img-title\">图04　双曲变换</span></span><span>差分方程如下：</span><span><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mrow><mo fence=\"true\">{</mo><mtable><mtr><mtd><mrow><msub><mi>x</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><msub><mi>k</mi><mi>n</mi></msub><mo>⋅</mo><mo>(</mo><msub><mi>x</mi><mn>0</mn></msub><mi>c</mi><mi>o</mi><mi>s</mi><mo>(</mo><msub><mi>z</mi><mn>0</mn></msub><mo>)</mo><mo>−</mo><msub><mi>y</mi><mn>0</mn></msub><mi>s</mi><mi>i</mi><mi>n</mi><mo>(</mo><msub><mi>z</mi><mn>0</mn></msub><mo>)</mo><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>y</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>y</mi><mi>i</mi></msub><mo>+</mo><msub><mi>k</mi><mi>n</mi></msub><mo>⋅</mo><mo>(</mo><msub><mi>y</mi><mn>0</mn></msub><mi>c</mi><mi>o</mi><mi>s</mi><mo>(</mo><msub><mi>z</mi><mn>0</mn></msub><mo>)</mo><mo>+</mo><msub><mi>x</mi><mn>0</mn></msub><mi>s</mi><mi>i</mi><mi>n</mi><mo>(</mo><msub><mi>z</mi><mn>0</mn></msub><mo>)</mo><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>z</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><msub><mi>d</mi><mi>i</mi></msub><mo>⋅</mo><mi>a</mi><mi>r</mi><mi>c</mi><mi>t</mi><mi>a</mi><mi>n</mi><mi>h</mi><mo>(</mo><msup><mn>2</mn><mrow><mo>−</mo><mi>i</mi></mrow></msup><mo>)</mo></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding=\"application/x-tex\">\\left\\{\\begin{matrix}</span><span>x_{i+1}=x_i+k_n\\cdot (x_0cos(z_0)-y_0sin(z_0))\\\\</span><span>y_{i+1}=y_i+k_n\\cdot (y_0cos(z_0)+x_0sin(z_0))\\\\</span><span>z_{i+1}=z_i-d_i\\cdot arctanh(2^{-i})</span><span>\\end{matrix}\\right.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"strut\" style=\"height:2.067332em;\"></span><span class=\"strut bottom\" style=\"height:3.6346640000000003em;vertical-align:-1.5673320000000004em;\"></span><span class=\"base displaystyle textstyle uncramped\"><span class=\"minner displaystyle textstyle uncramped\"><span class=\"mopen style-wrap reset-textstyle textstyle uncramped\"><span class=\"delimsizing mult\"><span class=\"vlist\"><span style=\"top:0.65001em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎩</span></span></span><span style=\"top:-0.000010000000000065512em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎨</span></span></span><span style=\"top:-1.15002em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎧</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist\"><span style=\"top:-1.2273319999999999em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mathrm mtight\">1</span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">+</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03148em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">n</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mord mathit\">c</span><span class=\"mord mathit\">o</span><span class=\"mord mathit\">s</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.04398em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mclose\">)</span><span class=\"mbin\">−</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mord mathit\">s</span><span class=\"mord mathit\">i</span><span class=\"mord mathit\">n</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.04398em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\">)</span></span></span><span style=\"top:-0.027331999999999634em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mathrm mtight\">1</span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">+</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03148em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">n</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mord mathit\">c</span><span class=\"mord mathit\">o</span><span class=\"mord mathit\">s</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.04398em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mclose\">)</span><span class=\"mbin\">+</span><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mord mathit\">s</span><span class=\"mord mathit\">i</span><span class=\"mord mathit\">n</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.04398em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\">)</span></span></span><span style=\"top:1.2073320000000003em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.04398em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mathrm mtight\">1</span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.04398em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">−</span><span class=\"mord\"><span class=\"mord mathit\">d</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathit\">c</span><span class=\"mord mathit\">t</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">n</span><span class=\"mord mathit\">h</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathrm\">2</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:-0.41300000000000003em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle uncramped mtight\"><span class=\"mord scriptstyle uncramped mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mathit mtight\">i</span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mclose\">)</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span><span class=\"mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span></span></span></span></span></span></span></p><p><span><em>旋转模式</em> 迭代的结果是：</span><span><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mrow><mo fence=\"true\">{</mo><mtable><mtr><mtd><mrow><msub><mi>x</mi><mi>n</mi></msub><mo>=</mo><msub><mi>k</mi><mi>n</mi></msub><mo>⋅</mo><mo>(</mo><msub><mi>x</mi><mn>0</mn></msub><mo>⋅</mo><mi>c</mi><mi>o</mi><mi>s</mi><mi>h</mi><mo>(</mo><msub><mi>z</mi><mn>0</mn></msub><mo>)</mo><mo>+</mo><msub><mi>y</mi><mn>0</mn></msub><mo>⋅</mo><mi>s</mi><mi>i</mi><mi>n</mi><mi>h</mi><mo>(</mo><msub><mi>z</mi><mn>0</mn></msub><mo>)</mo><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>y</mi><mi>n</mi></msub><mo>=</mo><msub><mi>k</mi><mi>n</mi></msub><mo>⋅</mo><mo>(</mo><msub><mi>y</mi><mn>0</mn></msub><mo>⋅</mo><mi>c</mi><mi>o</mi><mi>s</mi><mi>h</mi><mo>(</mo><msub><mi>z</mi><mn>0</mn></msub><mo>)</mo><mo>+</mo><msub><mi>x</mi><mn>0</mn></msub><mo>⋅</mo><mi>s</mi><mi>i</mi><mi>n</mi><mi>h</mi><mo>(</mo><msub><mi>z</mi><mn>0</mn></msub><mo>)</mo><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>z</mi><mi>n</mi></msub><mo>=</mo><mn>0</mn></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding=\"application/x-tex\">\\left\\{\\begin{matrix}</span><span>x_n=k_n\\cdot (x_0\\cdot cosh(z_0)+y_0\\cdot sinh(z_0))\\\\ </span><span>y_n=k_n\\cdot (y_0\\cdot cosh(z_0)+x_0\\cdot sinh(z_0))\\\\</span><span>z_n=0 </span><span>\\end{matrix}\\right.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"strut\" style=\"height:2.05002em;\"></span><span class=\"strut bottom\" style=\"height:3.60004em;vertical-align:-1.55002em;\"></span><span class=\"base displaystyle textstyle uncramped\"><span class=\"minner displaystyle textstyle uncramped\"><span class=\"mopen style-wrap reset-textstyle textstyle uncramped\"><span class=\"delimsizing mult\"><span class=\"vlist\"><span style=\"top:0.65001em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎩</span></span></span><span style=\"top:-0.000010000000000065512em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎨</span></span></span><span style=\"top:-1.15002em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎧</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist\"><span style=\"top:-1.2099999999999997em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">n</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03148em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">n</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mord mathit\">c</span><span class=\"mord mathit\">o</span><span class=\"mord mathit\">s</span><span class=\"mord mathit\">h</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.04398em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mclose\">)</span><span class=\"mbin\">+</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mord mathit\">s</span><span class=\"mord mathit\">i</span><span class=\"mord mathit\">n</span><span class=\"mord mathit\">h</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.04398em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\">)</span></span></span><span style=\"top:-0.00999999999999951em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">n</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03148em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">n</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mord mathit\">c</span><span class=\"mord mathit\">o</span><span class=\"mord mathit\">s</span><span class=\"mord mathit\">h</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.04398em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mclose\">)</span><span class=\"mbin\">+</span><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mord mathit\">s</span><span class=\"mord mathit\">i</span><span class=\"mord mathit\">n</span><span class=\"mord mathit\">h</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.04398em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\">)</span></span></span><span style=\"top:1.1900000000000006em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.04398em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">n</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord mathrm\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span><span class=\"mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span></span></span></span></span></span></span></p><p><span>其中比例系数为：</span><span><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><msub><mi>k</mi><mi>n</mi></msub><mo>=</mo><msub><mi>lim</mi><mrow><mi>n</mi><mo>→</mo><mi mathvariant=\"normal\">∞</mi></mrow></msub><msubsup><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>n</mi></mrow></msubsup><msqrt><mrow><mn>1</mn><mo>−</mo><msup><mn>2</mn><mrow><mo>−</mo><mn>2</mn><mi>i</mi></mrow></msup></mrow></msqrt><mo>=</mo><mn>1</mn><mi mathvariant=\"normal\">.</mi><mn>2</mn><mn>0</mn><mn>5</mn><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">k_n=\\lim_{n \\to \\infty }\\prod_{i=1}^{n}\\sqrt{1-2^{-2i}}=1.2051</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"strut\" style=\"height:1.6513970000000002em;\"></span><span class=\"strut bottom\" style=\"height:2.929066em;vertical-align:-1.277669em;\"></span><span class=\"base displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03148em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">n</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mop op-limits\"><span class=\"vlist\"><span style=\"top:0.6em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">n</span><span class=\"mrel mtight\">→</span><span class=\"mord mathrm mtight\">∞</span></span></span></span><span style=\"top:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span><span class=\"mop\">lim</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span><span class=\"mop op-limits\"><span class=\"vlist\"><span style=\"top:1.1776689999999999em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mathrm mtight\">1</span></span></span></span><span style=\"top:-0.000005000000000143778em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span><span class=\"mop op-symbol large-op\">∏</span></span></span><span style=\"top:-1.2500050000000003em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle uncramped mtight\"><span class=\"mord scriptstyle uncramped mtight\"><span class=\"mord mathit mtight\">n</span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span><span class=\"mord sqrt\"><span class=\"sqrt-sign\" style=\"top:-0.177547em;\"><span class=\"style-wrap reset-textstyle textstyle uncramped\"><span class=\"delimsizing size1\">√</span></span></span><span class=\"vlist\"><span style=\"top:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:1em;\">​</span></span><span class=\"mord displaystyle textstyle cramped\"><span class=\"mord mathrm\">1</span><span class=\"mbin\">−</span><span class=\"mord\"><span class=\"mord mathrm\">2</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:-0.289em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord scriptstyle cramped mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mathrm mtight\">2</span><span class=\"mord mathit mtight\">i</span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span></span><span style=\"top:-0.987547em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:1em;\">​</span></span><span class=\"reset-textstyle textstyle uncramped sqrt-line\"></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:1em;\">​</span></span>​</span></span></span><span class=\"mrel\">=</span><span class=\"mord mathrm\">1</span><span class=\"mord mathrm\">.</span><span class=\"mord mathrm\">2</span><span class=\"mord mathrm\">0</span><span class=\"mord mathrm\">5</span><span class=\"mord mathrm\">1</span></span></span></span></span></span></p><p><span><em>向量模式</em> 迭代的结果是：</span><span><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mrow><mo fence=\"true\">{</mo><mtable><mtr><mtd><mrow><msub><mi>x</mi><mi>n</mi></msub><mo>=</mo><msub><mi>k</mi><mi>n</mi></msub><msqrt><mrow><msubsup><mi>x</mi><mn>0</mn><mn>2</mn></msubsup><mo>−</mo><msubsup><mi>y</mi><mn>0</mn><mn>2</mn></msubsup></mrow></msqrt></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>y</mi><mi>n</mi></msub><mo>=</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>z</mi><mi>n</mi></msub><mo>=</mo><msub><mi>z</mi><mn>0</mn></msub><mo>+</mo><mi>a</mi><mi>r</mi><mi>c</mi><mi>t</mi><mi>a</mi><mi>n</mi><mi>h</mi><mo>(</mo><msub><mi>y</mi><mn>0</mn></msub><mi mathvariant=\"normal\">/</mi><msub><mi>x</mi><mn>0</mn></msub><mo>)</mo></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding=\"application/x-tex\">\\left\\{\\begin{matrix}</span><span>x_n=k_n\\sqrt{x_0^2-y_0^2}\\\\ </span><span>y_n=0\\\\</span><span>z_n=z_0+arctanh(y_0/x_0)</span><span>\\end{matrix}\\right.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"strut\" style=\"height:2.37001em;\"></span><span class=\"strut bottom\" style=\"height:4.24002em;vertical-align:-1.8700100000000002em;\"></span><span class=\"base displaystyle textstyle uncramped\"><span class=\"minner displaystyle textstyle uncramped\"><span class=\"mopen style-wrap reset-textstyle textstyle uncramped\"><span class=\"delimsizing mult\"><span class=\"vlist\"><span style=\"top:0.9500099999999998em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎩</span></span></span><span style=\"top:0.9500099999999998em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎪</span></span></span><span style=\"top:-0.000010000000000287557em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎨</span></span></span><span style=\"top:-1.1500100000000002em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎪</span></span></span><span style=\"top:-1.4500200000000003em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎧</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist\"><span style=\"top:-1.071325em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:1em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">n</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03148em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">n</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mord sqrt\"><span class=\"sqrt-sign\" style=\"top:-0.10868500000000014em;\"><span class=\"style-wrap reset-textstyle textstyle uncramped\"><span class=\"delimsizing size2\">√</span></span></span><span class=\"vlist\"><span style=\"top:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:1em;\">​</span></span><span class=\"mord displaystyle textstyle cramped\"><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.26630799999999993em;margin-left:0em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span style=\"top:-0.34480000000000005em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">2</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">−</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.26630799999999993em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span style=\"top:-0.34480000000000005em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">2</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span></span><span style=\"top:-1.218685em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:1em;\">​</span></span><span class=\"reset-textstyle textstyle uncramped sqrt-line\"></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:1em;\">​</span></span>​</span></span></span></span></span><span style=\"top:0.31000999999999995em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:1em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">n</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord mathrm\">0</span></span></span><span style=\"top:1.51001em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:1em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.04398em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">n</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.04398em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">+</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathit\">c</span><span class=\"mord mathit\">t</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">n</span><span class=\"mord mathit\">h</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mord mathrm\">/</span><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mclose\">)</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:1em;\">​</span></span>​</span></span></span></span></span><span class=\"mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span></span></span></span></span></span></span></p><p><span>看到<span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><msqrt><mrow><msubsup><mi>x</mi><mn>0</mn><mn>2</mn></msubsup><mo>−</mo><msubsup><mi>y</mi><mn>0</mn><mn>2</mn></msubsup></mrow></msqrt></mrow><annotation encoding=\"application/x-tex\">\\sqrt{x_0^2-y_0^2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"strut\" style=\"height:0.9498050000000001em;\"></span><span class=\"strut bottom\" style=\"height:1.24001em;vertical-align:-0.2902049999999999em;\"></span><span class=\"base textstyle uncramped\"><span class=\"mord sqrt\"><span class=\"sqrt-sign\" style=\"top:-0.05980500000000011em;\"><span class=\"style-wrap reset-textstyle textstyle uncramped\"><span class=\"delimsizing size1\">√</span></span></span><span class=\"vlist\"><span style=\"top:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:1em;\">​</span></span><span class=\"mord textstyle cramped\"><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.26630799999999993em;margin-left:0em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span style=\"top:-0.34480000000000005em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">2</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">−</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.26630799999999993em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">0</span></span></span><span style=\"top:-0.34480000000000005em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathrm mtight\">2</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span></span><span style=\"top:-0.869805em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:1em;\">​</span></span><span class=\"reset-textstyle textstyle uncramped sqrt-line\"></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:1em;\">​</span></span>​</span></span></span></span></span></span>形式，很容易就能想到这个可以用来计算平方根。</span></p><p><span>设被开平方数为<span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><msub><mi>x</mi><mi>s</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"strut\" style=\"height:0.43056em;\"></span><span class=\"strut bottom\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"base textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">s</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span></span></span>,则令初始向量为<span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mo>(</mo><msub><mi>x</mi><mi>s</mi></msub><mo>+</mo><mn>0</mn><mi mathvariant=\"normal\">.</mi><mn>2</mn><mn>5</mn><mo separator=\"true\">,</mo><msub><mi>x</mi><mi>s</mi></msub><mo>−</mo><mn>0</mn><mi mathvariant=\"normal\">.</mi><mn>2</mn><mn>5</mn><mo>)</mo></mrow><annotation encoding=\"application/x-tex\">(x_s+0.25,x_s-0.25)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"strut\" style=\"height:0.75em;\"></span><span class=\"strut bottom\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"base textstyle uncramped\"><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">s</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">+</span><span class=\"mord mathrm\">0</span><span class=\"mord mathrm\">.</span><span class=\"mord mathrm\">2</span><span class=\"mord mathrm\">5</span><span class=\"mpunct\">,</span><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">s</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">−</span><span class=\"mord mathrm\">0</span><span class=\"mord mathrm\">.</span><span class=\"mord mathrm\">2</span><span class=\"mord mathrm\">5</span><span class=\"mclose\">)</span></span></span></span>，边界条件为y<sub>n</sub>→0。</span><span>代入向量方程中，化解可得：</span><span><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><msqrt><mrow><msub><mi>x</mi><mi>s</mi></msub></mrow></msqrt><mo>=</mo><mfrac><mrow><msub><mi>x</mi><mi>n</mi></msub></mrow><mrow><msub><mi>k</mi><mi>n</mi></msub></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">\\sqrt{x_s}=\\frac{x_n}{k_n}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"strut\" style=\"height:1.10756em;\"></span><span class=\"strut bottom\" style=\"height:1.9435600000000002em;vertical-align:-0.8360000000000001em;\"></span><span class=\"base displaystyle textstyle uncramped\"><span class=\"mord sqrt\"><span class=\"sqrt-sign\" style=\"top:0.06584500000000004em;\"><span class=\"style-wrap reset-textstyle textstyle uncramped\">√</span></span><span class=\"vlist\"><span style=\"top:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:1em;\">​</span></span><span class=\"mord displaystyle textstyle cramped\"><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">s</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span></span><span style=\"top:-0.6941549999999999em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:1em;\">​</span></span><span class=\"reset-textstyle textstyle uncramped sqrt-line\"></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:1em;\">​</span></span>​</span></span></span><span class=\"mrel\">=</span><span class=\"mord reset-textstyle displaystyle textstyle uncramped\"><span class=\"mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist\"><span style=\"top:0.686em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle textstyle cramped\"><span class=\"mord textstyle cramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03148em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">n</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span></span></span><span style=\"top:-0.22999999999999998em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle textstyle uncramped frac-line\"></span></span><span style=\"top:-0.677em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle textstyle uncramped\"><span class=\"mord textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">n</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span><span class=\"mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span></span></span></span></span></span></span></p><h2 id=\"BE7BB9FE4B880CORDIC\">统一CORDIC</h2><p><span>经过以上的推导，我们已经可以看出，不管是在哪个坐标系下，迭代的形式都是大同小异的，无非就是差了几个正负号而已。而且，关于旋转模式和向量模式也都是通用的，几个坐标系下的计算过程也都是类似的，于是我们可以得出一个统一的CORDIC迭代方程为：</span><span><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mrow><mo fence=\"true\">{</mo><mtable><mtr><mtd><mrow><msub><mi>x</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mi>m</mi><mo>⋅</mo><msub><mi>d</mi><mi>i</mi></msub><mo>⋅</mo><msup><mn>2</mn><mrow><mo>−</mo><mi>i</mi></mrow></msup><mo>⋅</mo><msub><mi>y</mi><mi>i</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>y</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>y</mi><mi>i</mi></msub><mo>+</mo><msub><mi>d</mi><mi>i</mi></msub><mo>⋅</mo><msup><mn>2</mn><mrow><mo>−</mo><mi>i</mi></mrow></msup><mo>⋅</mo><msub><mi>x</mi><mi>i</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>z</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><msub><mi>d</mi><mi>i</mi></msub><mo>⋅</mo><msub><mi>θ</mi><mi>i</mi></msub></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding=\"application/x-tex\">\\left\\{\\begin{matrix}</span><span>x_{i+1}=x_i-m\\cdot d_i\\cdot 2^{-i}\\cdot y_i\\\\</span><span>y_{i+1}=y_i+d_i\\cdot 2^{-i}\\cdot x_i\\\\</span><span>z_{i+1}=z_i-d_i\\cdot \\theta_i</span><span>\\end{matrix}\\right.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"strut\" style=\"height:2.084664em;\"></span><span class=\"strut bottom\" style=\"height:3.6693279999999997em;vertical-align:-1.5846639999999996em;\"></span><span class=\"base displaystyle textstyle uncramped\"><span class=\"minner displaystyle textstyle uncramped\"><span class=\"mopen style-wrap reset-textstyle textstyle uncramped\"><span class=\"delimsizing mult\"><span class=\"vlist\"><span style=\"top:0.65001em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎩</span></span></span><span style=\"top:-0.000010000000000065512em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎨</span></span></span><span style=\"top:-1.15002em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎧</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist\"><span style=\"top:-1.21em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mathrm mtight\">1</span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">−</span><span class=\"mord mathit\">m</span><span class=\"mbin\">⋅</span><span class=\"mord\"><span class=\"mord mathit\">d</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mord\"><span class=\"mord mathrm\">2</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:-0.41300000000000003em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle uncramped mtight\"><span class=\"mord scriptstyle uncramped mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mathit mtight\">i</span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span></span><span style=\"top:0.024663999999999853em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mathrm mtight\">1</span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">+</span><span class=\"mord\"><span class=\"mord mathit\">d</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mord\"><span class=\"mord mathrm\">2</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:-0.41300000000000003em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle uncramped mtight\"><span class=\"mord scriptstyle uncramped mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mathit mtight\">i</span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span></span><span style=\"top:1.2246639999999995em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.04398em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mathrm mtight\">1</span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.04398em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">−</span><span class=\"mord\"><span class=\"mord mathit\">d</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mbin\">⋅</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.02778em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span><span class=\"mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span></span></span></span></span></span></span><span>其中：</span><span><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><msub><mi>θ</mi><mi>i</mi></msub><mo>=</mo><mrow><mo fence=\"true\">{</mo><mtable><mtr><mtd><mrow><mi>a</mi><mi>r</mi><mi>c</mi><mi>t</mi><mi>a</mi><mi>n</mi><mo>(</mo><msup><mn>2</mn><mrow><mo>−</mo><mi>i</mi></mrow></msup><mo>)</mo></mrow></mtd><mtd><mrow><mi>m</mi><mo>=</mo><mn>1</mn></mrow></mtd></mtr><mtr><mtd><mrow><msup><mn>2</mn><mrow><mo>−</mo><mi>i</mi></mrow></msup></mrow></mtd><mtd><mrow><mi>m</mi><mo>=</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd><mrow><mi>a</mi><mi>r</mi><mi>c</mi><mi>t</mi><mi>a</mi><mi>n</mi><mi>h</mi><mo>(</mo><mo>−</mo><msup><mn>2</mn><mrow><mo>−</mo><mi>i</mi></mrow></msup><mo>)</mo></mrow></mtd><mtd><mrow><mi>m</mi><mo>=</mo><mo>−</mo><mn>1</mn></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding=\"application/x-tex\">\\theta_i=\\left\\{\\begin{matrix}</span><span>arctan(2^{-i})&amp;m=1\\\\ </span><span>2^{-i}&amp;m=0\\\\ </span><span>arctanh(-2^{-i})&amp;m=-1</span><span>\\end{matrix}\\right.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"strut\" style=\"height:2.1019959999999998em;\"></span><span class=\"strut bottom\" style=\"height:3.703992em;vertical-align:-1.6019960000000002em;\"></span><span class=\"base displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.02778em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"minner displaystyle textstyle uncramped\"><span class=\"mopen style-wrap reset-textstyle textstyle uncramped\"><span class=\"delimsizing mult\"><span class=\"vlist\"><span style=\"top:0.65001em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎩</span></span></span><span style=\"top:-0.000010000000000065512em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎨</span></span></span><span style=\"top:-1.15002em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"delimsizinginner delim-size4\"><span>⎧</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist\"><span style=\"top:-1.2273319999999996em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord mathit\">a</span><span class=\"mord mathit\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathit\">c</span><span class=\"mord mathit\">t</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">n</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathrm\">2</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:-0.41300000000000003em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle uncramped mtight\"><span class=\"mord scriptstyle uncramped mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mathit mtight\">i</span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:0.007332000000000172em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathrm\">2</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:-0.41300000000000003em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle uncramped mtight\"><span class=\"mord scriptstyle uncramped mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mathit mtight\">i</span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span></span><span style=\"top:1.241996em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord mathit\">a</span><span class=\"mord mathit\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathit\">c</span><span class=\"mord mathit\">t</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">n</span><span class=\"mord mathit\">h</span><span class=\"mopen\">(</span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mord mathrm\">2</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:-0.41300000000000003em;margin-right:0.05em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle uncramped mtight\"><span class=\"mord scriptstyle uncramped mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mathit mtight\">i</span></span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mclose\">)</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist\"><span style=\"top:-1.2273319999999996em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord mathit\">m</span><span class=\"mrel\">=</span><span class=\"mord mathrm\">1</span></span></span><span style=\"top:0.007332000000000172em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord mathit\">m</span><span class=\"mrel\">=</span><span class=\"mord mathrm\">0</span></span></span><span style=\"top:1.241996em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord mathit\">m</span><span class=\"mrel\">=</span><span class=\"mord\">−</span><span class=\"mord mathrm\">1</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span><span class=\"mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span></span></span></span></span></span></span><span> <em>m = 1</em> 时为圆周变换， <em>m = 0</em> 时为线性变换， <em>m = -1</em> 时为双曲变换。</span><span><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><msub><mi>d</mi><mi>i</mi></msub><mo>=</mo><mrow><mo fence=\"true\">{</mo><mtable><mtr><mtd><mrow><mi>s</mi><mi>i</mi><mi>g</mi><mi>n</mi><mo>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>)</mo></mrow></mtd><mtd><mrow><mi>R</mi><mi>o</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>n</mi><mi>g</mi></mrow></mtd></mtr><mtr><mtd><mrow><mo>−</mo><mi>s</mi><mi>i</mi><mi>g</mi><mi>n</mi><mo>(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>)</mo></mrow></mtd><mtd><mrow><mi>V</mi><mi>e</mi><mi>c</mi><mi>t</mi><mi>o</mi><mi>r</mi></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding=\"application/x-tex\">d_i=\\left\\{\\begin{matrix}</span><span>sign(x_i)&amp;Rotating\\\\ </span><span>-sign(y_i)&amp;Vector</span><span>\\end{matrix}\\right.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"strut\" style=\"height:1.45em;\"></span><span class=\"strut bottom\" style=\"height:2.40003em;vertical-align:-0.95003em;\"></span><span class=\"base displaystyle textstyle uncramped\"><span class=\"mord\"><span class=\"mord mathit\">d</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mrel\">=</span><span class=\"minner displaystyle textstyle uncramped\"><span class=\"mopen style-wrap reset-textstyle textstyle uncramped\" style=\"top:0em;\"><span class=\"delimsizing size3\">{</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist\"><span style=\"top:-0.6099999999999999em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord mathit\">s</span><span class=\"mord mathit\">i</span><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathit\">n</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathit\">x</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:0.5900000000000003em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord\">−</span><span class=\"mord mathit\">s</span><span class=\"mord mathit\">i</span><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathit\">n</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.03588em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped mtight\"><span class=\"mord mathit mtight\">i</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span><span class=\"mclose\">)</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist\"><span style=\"top:-0.6099999999999999em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord mathit\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord mathit\">o</span><span class=\"mord mathit\">t</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">t</span><span class=\"mord mathit\">i</span><span class=\"mord mathit\">n</span><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">g</span></span></span><span style=\"top:0.5900000000000003em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"mord displaystyle textstyle uncramped\"><span class=\"mord mathit\" style=\"margin-right:0.22222em;\">V</span><span class=\"mord mathit\">e</span><span class=\"mord mathit\">c</span><span class=\"mord mathit\">t</span><span class=\"mord mathit\">o</span><span class=\"mord mathit\" style=\"margin-right:0.02778em;\">r</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span></span></span><span class=\"mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter\"></span></span></span></span></span></span></span><span> <em>Rotating</em> 为旋转模式； <em>Vector</em> 为向量模式。</span></p><h1 id=\"BE8AFAFE5B7AEE58886E69E90\">误差分析</h1><p><span>为了进一步分析CORDIC算法的优劣和使用，这里使用Matlab对4种三角函数(sin,tan,asin,atan)以及开根号进行了误差测试，在函数定义域内分成100000个点进行测试，定点放大系数256倍，输入放大系数1024倍。</span></p><p><span><img class=\"img-block\" src=\"/img/algorithm-CRODIC/05.png\" alt=\"sin的误差散点图\" title=\"sin的误差散点图\"><span class=\"img-title\">图05　sin的误差散点图</span></span><span>这是 <em>sin</em> 的绝对误差散点图，它的误差范围为 <em>-0.0019 ≤ Error ≤ 0.0017</em> 。</span></p><p><span><img class=\"img-block\" src=\"/img/algorithm-CRODIC/06.png\" alt=\"tan的误差散点图\" title=\"tan的误差散点图\"><span class=\"img-title\">图06　tan的误差散点图</span></span><span>对于 <em>tan</em> ，由于它在接近 <em>π/2</em> 的时候达到无穷大，而CORDIC算法是达不到的，所以在接近 <em>π/2</em> 的时候误差陡然上升，必须要提出的是，当 <em>Error = 0.02</em> 的时候，角度为 <em>θ=77°</em> ，之后随着角度的增加，误差会越来越大。</span></p><p><span><img class=\"img-block\" src=\"/img/algorithm-CRODIC/07.png\" alt=\"arctan的误差散点图\" title=\"arctan的误差散点图\"><span class=\"img-title\">图07　arctan的误差散点图</span></span><span>这是 <em>arctan</em> ，误差范围为 <em>-0.0875 ≤ Error ≤ 0.1564</em> 。</span></p><p><span><img class=\"img-block\" src=\"/img/algorithm-CRODIC/08.png\" alt=\"开根号运算的误差散点图\" title=\"开根号运算的误差散点图\"><span class=\"img-title\">图08　开根号运算的误差散点图</span></span><span>对于 <em>开根号</em> 而言，很明显的在 <em>[1,2]</em> 区间内的误差是最小的，达到了小数点后四位的精度，但是面对超出这个范围的数要怎么办呢？可以采用手动缩放的办法，将数字乘以一个已知开方或者是平方数的数字将数字变换到 <em>[1,2]</em> 区间内。</span></p><p><span><img class=\"img-block\" src=\"/img/algorithm-CRODIC/09.png\" alt=\"arcsin的误差散点图\" title=\"arcsin的误差散点图\"><span class=\"img-title\">图09　arcsin的误差散点图</span></span><span>最后是 <em>arcsin</em> ，这个函数的精度非常糟糕，我至今不明白为什么会出现这种情况。从图形上来看，很明显误差是近似于一次函数的误差，于是通过分段一次函数对arcsinarcsin进行矫正。下图是矫正之后的误差散点图。</span></p><p><span><img class=\"img-block\" src=\"/img/algorithm-CRODIC/10.png\" alt=\"矫正之后的arcsin误差散点图\" title=\"矫正之后的arcsin误差散点图\"><span class=\"img-title\">图10　矫正之后的arcsin误差散点图</span></span><span>进行矫正之后，误差比起矫正之前小了一个数量级，但是依旧比较难看，勉强能用就是了……</span></p><h1 id=\"BE680BBE7BB93\">总结</h1><p><span>总的来说，CORDIC算法的理论并不复杂，写成代码之后也只是很短小的一段。但是个人觉得这实在是一个非常有趣的算法，这消除乘法的方法堪称绝妙，非常值得一看。</span><span>从误差上来看，sin、cos、开根号、arctan，这四种算法的误差比较理想，其余的最好还是根据情况酌情使用。</span></p>"}